<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Administering Logging - Sun GlassFish Enterprise Server v3 Prelude Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
</head>

<body>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&#160;</td>
<td><a href="p11.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p13.html">Next</a></td>
</tr>
</table>


<a name="abluj"></a>Chapter&#160;9<h3>Administering Logging</h3><a name="indexterm-376"></a><a name="indexterm-377"></a><p>This chapter provides instructions on how to configure logging and how to view
log information in the Sun GlassFish<sup>TM</sup> Enterprise Server v3 Prelude environment.</p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#abluk">About Logging</a></p></li>
<li><p><a href="#ghgwi">Configuring Logging</a></p></li>
<li><p><a href="#ghmdy">Viewing Log Information</a></p></li></ul>


<a name="abluk"></a><h3>About Logging</h3>
<a name="indexterm-378"></a><a name="indexterm-379"></a><p><b>Logging</b> is the process by which Enterprise Server captures data about events that
occur during Enterprise Server operation. This data is recorded in a log file
and is usually the first source of information when Enterprise Server problems occur.
</p><p>Although application components can use the Apache Commons Logging Library to record messages,
the platform standard JSR 047 API is recommended for better log configuration.</p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ablul">Log File </a></p></li>
<li><p><a href="#ghgvc">Configuration File </a></p></li>
<li><p><a href="#ablum">Logger Namespaces</a></p></li></ul>


<a name="ablul"></a><h4>Log File </h4>
<a name="indexterm-380"></a><a name="indexterm-381"></a><a name="indexterm-382"></a><a name="indexterm-383"></a><p>Enterprise Server log records are captured in the <tt>server.log</tt> file, typically located in
<i>domain-dir</i><tt>/logs</tt>. You can change the default name or location of the log file
by following instructions in <a href="#ghmek">To Change the Log File Name or Directory</a>.</p><p>Enterprise Server log records follow a uniform format:</p><pre></pre><pre>[#|<i>yyyy</i>-<i>mm</i>-<i>dd</i>T<i>hh</i>:<i>mm</i>:<i>ss</i>.<i>SSS</i>-<i>Z</i>|<i>Log Level</i>|<i>ProductName-Version</i>|<i>LoggerName</i>|<i>Key Value Pairs</i>|<i>Message</i>|#]</pre>
<ul><li><p><tt>[#</tt> and <tt>#]</tt> mark the beginning and end of the record.</p></li>
<li><p>The vertical bar (<tt>|</tt>) separates the fields of the record.</p></li>
<li><p><i>yyyy-mm-ddThh:mm:ss.SSSS-Z</i> specifies the date and time that the record was created. For example: <tt>2006-10-21T13:25:53.852-0400</tt> </p></li>
<li><p><i>Log Level</i> specifies the desired log level. You can select any of the following values: <tt>SEVERE</tt>, <tt>WARNING</tt>, <tt>INFO</tt>, <tt>CONFIG</tt>, <tt>FINE</tt>, <tt>FINER</tt>, and <tt>FINEST</tt>. The default is <tt>INFO</tt>.</p></li>
<li><p><i>ProductName-Version</i> refers to the current version of the Enterprise Server. For example: <tt>glassfish</tt></p></li>
<li><p><i>LoggerName</i> is a hierarchical logger namespace that identifies the source of the log module. For example: <tt>javax.enterprise.system.core</tt></p></li>
<li><p><i>Key Value Pairs</i> refers to pairs of key names and values, typically a thread ID. For example: <tt>_ThreadID=14;</tt></p></li>
<li><p><b>Message</b> is the text of the log message. For all Enterprise Server <tt>SEVERE</tt> and <tt>WARNING</tt> messages and for many <tt>INFO</tt> messages, the message begins with a message ID that consists of a module code and a numerical value. For example: <tt>CORE5004</tt></p></li></ul>
<p>An example log record might look like this:</p><pre>[#|2006-10-21T13:25:53.852-0400|INFO|GlassFish10.0|javax.enterprise.
system.core|_ThreadID=13;|CORE5004: Resource Deployed: 
[cr:jms/DurableConnectionFactory].|#]</pre>

<a name="ghgvc"></a><h4>Configuration File </h4>
<a name="indexterm-384"></a><a name="indexterm-385"></a><p>You can configure logging by editing the <tt>logging.properties</tt> file. The default <tt>logging.properties</tt> file
is located in the same directory as the <tt>domain.xml</tt> file, typically <i>domain-dir</i><tt>/config</tt>. You
can choose a different file name by using the <tt>java.util.logging.config.file</tt> system property to specify
a file name. For example:</p><pre> java -Djava.util.logging.config.file=myfile</pre>

<a name="ablum"></a><h4>Logger Namespaces</h4>
<a name="indexterm-386"></a><a name="indexterm-387"></a><p>A logger is provided for each Enterprise Server module. The following table lists
the names of the modules and the namespace for each logger. </p><a name="ggobw"></a><h6>Table&#160;9-1 Logger Namespaces for Enterprise Server Modules</h6><table><col width="20%"><col width="79%"><tr><th align="left" valign="top" scope="column"><p>Module
Name</p></th>
<th align="left" valign="top" scope="column"><p>Namespace</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Admin</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.tools.admin</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Classloader</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.core.classloading</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Configuration</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.core.config</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Deployment</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.tools.deployment</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Persistence</p></td>
<td align="left" valign="top" scope="row"><p><tt>oracle.toplink.essentials</tt>, <tt>javax.enterprise.resource.jdo</tt>, <tt>javax.enterprise.system.container.cmp</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Root</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Security</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.core.security</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Util</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.util</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Verifier</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.tools.verifier</tt></p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Web container</p></td>
<td align="left" valign="top" scope="row"><p><tt>javax.enterprise.system.container.web </tt><tt>org.apache.catalina</tt> <tt>org.apache.coyote</tt> <tt>org.apache.jasper</tt></p></td>
</tr>
</table>

<a name="ghgwi"></a><h3>Configuring Logging</h3>
<a name="indexterm-388"></a><a name="indexterm-389"></a><p>This section explains how to configure logging for Enterprise Server by setting properties
in the <tt>logging.properties</tt> file. Log level configuration changes are dynamic and do not
require that you restart the server, but other configuration changes do require you
to restart the server. </p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ghgwq">Configuring Log Handler Elements</a></p></li>
<li><p><a href="#ghmah">Setting Log Levels</a></p></li>
<li><p><a href="#ghmek">To Change the Log File Name or Directory</a></p></li></ul>


<a name="ghgwq"></a><h4>Configuring Log Handler Elements</h4>
<a name="indexterm-390"></a><a name="indexterm-391"></a><p>The following tasks apply to configuring log handler elements:</p>
<ul><li><p><a href="#ghmbm">To Set Handler-Specific Properties</a></p></li>
<li><p><a href="#ghmen">To Add a Log Handler</a></p></li></ul>


<a name="ghmbm"></a><h5>To Set Handler-Specific Properties</h5>
<a name="indexterm-392"></a><a name="indexterm-393"></a><a name="indexterm-394"></a><p>You can modify logging behavior by setting properties in the <tt>logging.properties</tt> file
as follows:</p><ol>
<li><b>In a text editor, find the property that you want to modify
and make your changes.</b><p>The following properties are available:</p><dl><dt>File Description</dt>
<dd><p>Contains the name and location of the log file. By default, the name is <tt>server.log</tt> and the location is the <tt>logs</tt> directory. These can be changed.</p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.file=logs/server.log</pre></dd>
<dt>File Rotation Time Limit </dt>
<dd><p>Rotates the log file based on time in minutes. If defined, time limit takes precedence over size limit. If set to 0 (the default), there is no rotation based on time.</p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.rotationTimelimitInMinutes=0</pre></dd>
<dt>File Rotation Size Limit</dt>
<dd><p> Rotates the log file based on limit in bytes. If set to 0 (the default), there is no rotation based on file size. 500000 is the minimum.</p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.rotationLimitInBytes=0</pre></dd>
<dt>Formatter</dt>
<dd><p>Uses <tt>UniformLogFormatter</tt> to format the records in the log file.</p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.formatter=com.
sun.enterprise.server.logging.UniformLogFormatter</pre></dd>
</dl>
</li>
<li><b>Save the file.</b></li>
<li><b>To apply your changes, restart Enterprise Server.</b><ol style="list-style-type: lower-alpha">
<li><b>Stop Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoch">To Stop a Domain (or Server)</a>.</p></li>
<li><b>Start Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoda">To Start a Domain (or Server)</a>.</p></li></ol></li></ol><a name="ghmem"></a><h6>Example&#160;9-1 Changing a Handler-Specific Logging Property</h6><p>The following example changes the <tt>rotationTimelimitInMinutes</tt> from 0 (the default) to 90 minutes:</p><p>Before: </p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.rotationTimelimitInMinutes=0</pre><p>After: :</p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.rotationTimelimitInMinutes=90</pre>

<a name="ghmen"></a><h5>To Add a Log Handler</h5>
<a name="indexterm-395"></a><a name="indexterm-396"></a><p>A comma-separated list of log handlers is installed during startup of the Java<sup>TM</sup>
Virtual Machine (JVM<sup>TM</sup>) host. The default log handler that is provided in the
<tt>logging. properties</tt> file, <tt>ConsoleHandler</tt>, is configured as follows:</p><pre>handlers= java.util.logging.ConsoleHandler</pre><p>In Enterprise Server, the best approach to developing a handler is to
define a Hundred-Kilobyte Kernel (HK2) component which implements the handler contract. Enterprise Server
registers this handler automatically because it is an HK2 component, and there is
no task required of the administrator.</p><p>To implement a new handler that is not developed as an HK2
component, you need to add the new handler to the <tt>logging.properties</tt> file after the
developer has put the new handler JAR file into the <tt>/lib</tt> directory.</p><ol>
<li><b>In a text editor, add the new file handler to the line
that begins with <tt>handlers=</tt>.</b></li>
<li><b>Save the file.</b></li>
<li><b>To apply your changes, restart Enterprise Server.</b><ol style="list-style-type: lower-alpha">
<li><b>Stop Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoch">To Stop a Domain (or Server)</a>.</p></li>
<li><b>Start Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoda">To Start a Domain (or Server)</a>.</p></li></ol></li></ol><a name="ghphb"></a><h6>Example&#160;9-2 Adding a New Log Handler</h6><p>The following example adds the new logger <tt>com.example.logging.MyHandler</tt>:</p><p>Before: </p><pre>handlers= java.util.logging.ConsoleHandler</pre><p>After: </p><pre>handlers= java.util.logging.ConsoleHandler, com.example.logging.MyHandler</pre>

<a name="ghmah"></a><h4>Setting Log Levels</h4>
<p>The <b>log level</b> describes the type of material that is contained in the message.
The following values apply: <tt>SEVERE</tt>, <tt>WARNING</tt>, <tt>INFO</tt>, <tt>CONFIG</tt>, <tt>FINE</tt>, <tt>FINER</tt>, and <tt>FINEST</tt>.
These log levels are hierarchically inclusive, which means that if you set a
particular log level, such as INFO, the messages that have log levels above
that level (<tt>SEVERE</tt> and <tt>WARNING</tt>) are also included. If you set the log level
to the lowest level, <tt>FINEST</tt>, your output will include all the messages in
the file. The default setting is <tt>INFO</tt>.</p><p>There are two levels of log settings available: global and logger-specific. If you
have chosen a logger-specific setting that is different from the global setting, the
logger-specific setting takes precedence. </p><p>Because setting log levels is a dynamic operation, you do not need
to restart Enterprise Server for changes to take effect.</p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ghmep">To Set the Global Log Level</a></p></li>
<li><p><a href="#ghmdu">To Set Logger-Specific Properties</a></p></li></ul>


<a name="ghmep"></a><h5>To Set the Global Log Level</h5>
<p>The <b>global log level</b> specifies which kinds of events are logged across all loggers. The
default level for message output to the console is <tt>INFO</tt> (which also includes
<tt>SEVERE</tt> and <tt>WARNING</tt> messages). </p><p>The <tt>ConsoleHandler</tt> has a separate log level setting that limits the messages that
are displayed. For example:</p><pre>java.util.logging.ConsoleHandler.level = INFO 
java.util.logging.ConsoleHandler.formatter = 
com.sun.enterprise.server.logging.UniformLogFormatter</pre><ol>
<li><b>In a text editor, find the <tt>ConsoleHandler</tt> log level line and make your
changes.</b></li>
<li><b>Save the file.</b></li></ol><a name="ghmfi"></a><h6>Example&#160;9-3 Changing the Global Log Level for All Loggers</h6><p>If you set the log level at the root level, you are
setting the level of all loggers. The following example sets the log level
for all loggers to <tt>INFO</tt>:</p><pre>.level= INFO</pre>

<a name="ghmdu"></a><h5>To Set Logger-Specific Properties</h5>
<a name="indexterm-397"></a><a name="indexterm-398"></a><a name="indexterm-399"></a><p><b>Logger-specific properties</b> provide extra control for the logger of each module. By default, these
properties are set to log level <tt>FINE</tt> in the <tt>logging. properties</tt> file, however, the lines
in the file are commented out. The lines for the loggers might look
like this (the modules are indicated in bold):</p><pre>#javax.enterprise.system.<tt><b>tools</b></tt>.level=FINE
#javax.enterprise.system.container.<tt><b>ejb</b></tt>.level=FINE
#javax.enterprise.system.core.<tt><b>security</b></tt>.level=FINE
#javax.enterprise.system.tools.<tt><b>admin</b></tt>.level=FINE
#javax.<tt><b>enterprise</b></tt>.level=FINE
#javax.enterprise.system.container.<tt><b>web</b></tt>.level=FINE</pre><p>For any given module logger, such as the EJB logger, the global
log level can be overridden by the module-specific setting. </p><ol>
<li><b>In a text editor, uncomment the line that applies to the logger that
you want to modify.</b><p>Remove the #. The logger is activated using the default level INFO.</p></li>
<li><b>Set the property to the desired log level.</b><p>Your choices are <tt>SEVERE</tt>, <tt>WARNING</tt>, <tt>INFO</tt>, <tt>CONFIG</tt>, <tt>FINE</tt>, <tt>FINER</tt>, and <tt>FINEST</tt>. </p></li>
<li><b>Save the file.</b><p>The log levels are automatically updated.</p></li></ol><a name="ghmev"></a><h6>Example&#160;9-4 Changing the Log Level for the Console Handler</h6><p>The following example changes the log level for <tt>ConsoleHandler</tt> from INFO to FINE</p><p>Before: </p><pre>java.util.logging.ConsoleHandler.level = INFO</pre><p>After: </p><pre>java.util.logging.ConsoleHandler.level = FINE</pre><a name="ghmdv"></a><h6>Example&#160;9-5 Setting a Log Level for a Specific Logger</h6><p>The following example sets the log level for the EJB logger to
SEVERE (overriding the global level INFO)</p><p>Before:</p><pre>#javax.enterprise.system.container.ejb.level=FINE</pre><p>After: :</p><pre>javax.enterprise.system.container.ejb.level=SEVERE</pre>

<a name="ghmek"></a><h4>To Change the Log File Name or Directory</h4><a name="indexterm-400"></a><a name="indexterm-401"></a><p>By default, the name of the log output file is <tt>server.log</tt> and it
is located in <i>domain-dir</i><tt>/logs</tt>. You can change the name or location of the
file by editing the <tt>logging.properties</tt> file as follows:</p><ol>
<li><b>In a text editor, find the following line:</b><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.file=logs/server.log</pre><p>In this line, <tt>logs</tt> indicates the directory where the file is located, and
<tt>server.log</tt> is the file name.</p></li>
<li><b>Make your changes and save the file.</b></li>
<li><b>To apply your changes, restart Enterprise Server.</b><ol style="list-style-type: lower-alpha">
<li><b>Stop Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoch">To Stop a Domain (or Server)</a>.</p></li>
<li><b>Start Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoda">To Start a Domain (or Server)</a>.</p></li></ol></li></ol><a name="ghmhd"></a><h6>Example&#160;9-6 Changing the Name and Location of the Log File</h6><p>The following example changes the log file name from <tt>server.log</tt> to <tt>myLogging.log</tt>
and changes the location from the <tt>logs</tt> directory to the <tt>dpin</tt> directory:</p><p>Before: </p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.file=logs/server.log</pre><p>After:</p><pre>com.sun.enterprise.server.logging.FileandSyslogHandler.file=dpin/myLogging.log</pre>

<a name="ghmdy"></a><h3>Viewing Log Information</h3>
<a name="indexterm-402"></a><a name="indexterm-403"></a><p>By default, all log information is captured in the <tt>server.log</tt> file, typically located
in <i>domain-dir</i><tt>/logs</tt>. To view information that has been collected for a module, you
can open the <tt>server.log</tt> file in a text editor and search for
the module that you are interested in.</p><p>You can also use the command-line file viewing commands, such as <tt>tail</tt>,
<tt>grep</tt>, or <tt>more</tt>.</p>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p11.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p13.html">Next</a></td>
</tr>
</table>



</body>
</html>

