<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Enterprise Server Overview - Sun GlassFish Enterprise Server 2.1 Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-12-01">
</head>

<body>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&#160;</td>
<td><a href="p3.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p5.html">Next</a></td>
</tr>
</table>


<a name="ablaq"></a>Chapter&#160;1<h3>Enterprise Server Overview</h3><p>Sun GlassFish Enterprise Server administration includes many tasks such as deploying  applications,
creating and configuring domains, server instances and resources; controlling (starting and stopping) domains and
server instances, managing profiles and clusters, monitoring and managing performance, and diagnosing and
troubleshooting problems. </p><p> Enterprise Server provides a Java EE compatible server for the development and
deployment of Java EE  applications and Java Web Services. Key features include
scalable transaction management, container-managed persistence runtime, performant web services, clustering, high availability, security, and
integration capabilities. </p>

<a name="ablar"></a><h3>Enterprise Server Overview and Concepts</h3>
<p>This section contains the following topics:</p>
<ul><li><p><a href="#ablat">Enterprise Server Overview</a></p></li>
<li><p><a href="#ablav">Tools for Administration</a></p></li></ul>


<a name="ablat"></a><h4>Enterprise Server Overview</h4>
<p>You can configure and monitor Enterprise Server instances and clusters securely and remotely,
from a web-based central administration console.  The command line interface (CLI) can
be used to script and automate processes. A stable JMX API is made
available to programmatically monitor the server, query configuration and change configuration data. Monitoring
is supported through JMX and SNMP interfaces. Monitoring level may be varied dynamically from
OFF to LOW and high, changing the amount of information that is
collected.</p><p>You can configure and optimize Enterprise Server for a particular type of use
by specifying the appropriate profile when you create the application server domain. </p><p>Enterprise Server includes the Metro web services stack  (http://metro.dev.java.net). Metro implements important
WS-* standards and WS-I standardized interoperability profiles in order to assure interoperability between
Java and .NET web services.</p><p>Enterprise Server includes the implementation of Java Business Integration (JBI) specifications. JBI is
a Java standard for structuring business systems according to a Service-Oriented Architecture (SOA).</p>

<a name="ablav"></a><h4>Tools for Administration</h4>
<p>The Enterprise Server provides the following administration tools and APIs:</p>
<ul><li><p><a href="#ablaw">Admin Console</a></p></li>
<li><p><a href="#ablax">Command-line Interface (<tt>asadmin</tt> Utility)</a></p></li>
<li><p><a href="#geold">JConsole</a></p></li></ul>


<a name="ablaw"></a><h5>Admin Console</h5>
<p>The Admin Console is<a name="indexterm-1"></a> a browser-based tool that features an easy-to-navigate interface and
online help. The administration server (also called the Domain Administration Server or DAS)
must be running to use the Admin Console. To, launch the Administration Console,
you must know the administration server hostname and port number. When the Enterprise
Server was installed, you chose a port number for the server, or used
the default port of 4848. You also specified a user name and
master password.</p><p>To start the Admin Console, in a web browser type:</p><pre>http://<tt>hostname</tt>:<tt>port</tt></pre><p>For example:</p><pre>http://kindness.sun.com:4848</pre><p>If the Admin Console is running on the machine on which the
Enterprise Server was installed, specify <tt>localhost</tt> for the host name.</p><p>On Windows, start the Enterprise Server Admin Console from the Start menu.</p><p>The installation program creates the default administrative domain (named <tt>domain1</tt>) with the
default port number 4848, as well as an instance separate from the domain
administration server (DAS). After installation, additional administration domains can be created. Each domain
has its own domain administration server, which has a unique port number. When
specifying the URL for the Admin Console, be sure to use the port
number for the domain to be administered.</p><p>If your configuration includes remote server instances, create node agents to manage and
facilitate remote server instances. It is the responsibility of the node agent to
create, start, stop, and delete a server instance. Use the command line interface
(CLI) commands to set up node agents.</p>

<a name="ablax"></a><h5>Command-line Interface (<tt>asadmin</tt> Utility)</h5>
<p><a name="indexterm-2"></a><a name="indexterm-3"></a>The <tt>asadmin</tt> utility is a command-line interface for the Sun GlassFish Enterprise Server.
Use the <tt>asadmin</tt> utility and the commands associated with it to perform
the same set of administrative tasks offered by the Admin Console. The default installation
root directory on Solaris is <tt>/opt/SUNWappserver</tt>.</p><p>To start the <tt>asadmin</tt> utility, go to the <i>as-install</i>/bin directory and enter:</p><pre>$ ./asadmin</pre><p>To list the commands available within <tt>asadmin</tt>:</p><pre>asadmin> help</pre><p>It is also possible to issue an <tt>asadmin</tt> command at the shell&#8217;s command
prompt:</p><pre>$ asadmin help</pre><p>To view a command&#8217;s syntax and examples, type <tt>help</tt> followed by the command
name. For example:</p><pre>asadmin> help create-jdbc-resource</pre><p>The <tt>asadmin help</tt> information for a given command displays the UNIX man page of
the command. These man pages are also available in HTML and PDF format
in the <a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a>.</p>

<a name="geold"></a><h5>JConsole</h5>
<p>JConsole is used to monitor the Sun GlassFish Enterprise Server. You can use
either the JConsole remote tab, or the advanced tab to connect to the
Enterprise Server.</p>
<ul><li><p>Remote Tab: identify the username, password, administration server host, and JMS port number (8686 by default), and select Connect.</p></li>
<li><p>Advanced Tab: identify the <tt>JMXServiceURL</tt> as service:<tt>jmx:rmi:///jndi/rmi://host:jms-port/jmxrmi</tt> and select Connect. The <tt>JMXServerURL</tt> is printed in the <tt>server.log</tt> file as well as output in the command window of the domain creation command.</p></li></ul>


<a name="ablaz"></a><h3>Enterprise Server Concepts</h3>
<p>The Enterprise Server consists of one or more domains. A domain is
an administrative boundary or context. Each domain has an administration server (also called Domain
Administration Server or DAS) associated with it and consists of zero or more
standalone instances and/or clusters. Each cluster has one or more homogeneous server instances.
A server instance is a single Java Virtual Machine (JVM) that runs the
Application Server on a single physical machine. Server instances (whether standalone or clustered)
in a domain can run on different physical hosts.</p><p>This section contains the following topics:</p>
<ul><li><p><a href="#geojp">Domain</a></p></li>
<li><p><a href="#geojl">Domain Administration Server (DAS)</a></p></li>
<li><p><a href="#gelvk">Usage Profiles</a></p></li>
<li><p><a href="#geomm">Cluster</a></p></li>
<li><p><a href="#geomg">Node Agent</a></p></li>
<li><p><a href="#geolm">Server Instance</a></p></li></ul>


<a name="geojp"></a><h4>Domain</h4>
<p>A domain is a group of instances that are administered together. However, an
application server instance can belong to just one domain. In addition to the
administration boundary, a domain provides the basic security structure whereby different administrators can
administer specific groups (domains) of application server instances. By grouping the server instances
into separate domains, different organizations and administrators can share a single Enterprise Server
installation. Each domain has its own configuration, log files, and application deployment areas that
are independent of other domains. If the configuration is changed for one domain,
the configurations of other domains are not affected.</p><p>The Sun GlassFish Enterprise Server installer creates the default administrative domain (named <tt>domain1</tt>).
It also creates an associated domain administration server (named <tt>server</tt>). You must provide the
administration server port number. The default administration server port is 4848. The installer
also queries for the administration username and master password. After installation, additional administration
domains can be created.</p>

<a name="geojl"></a><h4>Domain Administration Server (DAS)</h4>
<p>Each domain has its own Domain Administration Server (DAS) with a unique port
number. The Admin Console communicates with a specific DAS to administer the associated
domain. Each Admin Console session allows you to configure and manage the specific
domain.</p><p>The Domain Administration Server (DAS), is a specially-designated application server instance that hosts
the administrative applications. The DAS authenticates the administrator, accepts requests from administration tools,
and communicates with server instances in the domain to carry out the requests.
The DAS is sometimes referred to as the admin server or default server.
It is referred to as the default server because it is the only
server instance that gets created on Sun GlassFish Enterprise Server installation and can
be used for deployments. The DAS is simply a server instance with additional
administration capabilities.</p><p>Each Admin Console session allows you to configure and manage a single domain.
If you created multiple domains, you must start an additional Admin Console
session to manage the other domains. When specifying the URL for the Admin
Console, be sure to use the port number of the DAS associated with
the domain to be administered.</p>

<a name="gelvk"></a><h4>Usage Profiles</h4>
<p>Every administrative domain is associated with a usage profile, which identifies the capabilities
of that domain. Enterprise Server provides the following profiles:</p>
<ul><li><p><b>Developer:</b> Use this profile if you are running your domain in a development environment and if your applications do not need the NSS keystore or clustering features, such as load balancing, and session persistence.</p></li>
<li><p><b>Cluster:</b> Use this profile if you need to create clusters but do not require the high-availability database (HADB) or the NSS keystore. </p></li>
<li><p><b>Enterprise:</b>: Use this profile if you need HADB and NSS. This profile is usable only if you install HADB and NSS separately or if you install Enterprise Server as part of enterprise offerings, such as Java Enterprise System (JES). For information on how you can use the enterprise profile with Enterprise Server, see Using the Enterprise Profile</p></li></ul>
<p>The domain provides a preconfigured runtime for the user applications. Usage profiles facilitates
the distinction between the Application Server binaries and the runtime configuration. Profiles enable
you to use the same installation of Enterprise Server to create different domains
with profiles that suit specific needs. For example, a developer may want to
use the Enterprise Server to get to know the latest Java EE specifications.
This developer does not need stringent security settings. Another user who wants to
deploy applications in a production environment needs an inherently secure environment. </p><p><a href="#gemmx">Table&#160;1-1</a> lists the features available with each profile:</p><a name="gemmx"></a><h6>Table&#160;1-1 Features Available for Each Profile</h6><table><col width="31%"><col width="21%"><col width="22%"><col width="24%"><tr><th align="left" valign="top" scope="column"><p>Feature</p></th>
<th align="left" valign="top" scope="column"><p>Developer Profile</p></th>
<th align="left" valign="top" scope="column"><p>Cluster Profile</p></th>
<th align="left" valign="top" scope="column"><p>Enterprise Profile (not available
with Sun GlassFish Communications Server)</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Security store</p></td>
<td align="left" valign="top" scope="row"><p>JKS</p></td>
<td align="left" valign="top" scope="row"><p>JKS</p></td>
<td align="left" valign="top" scope="row"><p>NSS</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Clustering/Standalone instances</p></td>
<td align="left" valign="top" scope="row"><p>Not available</p></td>
<td align="left" valign="top" scope="row"><p>Available</p></td>
<td align="left" valign="top" scope="row"><p>Available</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Security Manager</p></td>
<td align="left" valign="top" scope="row"><p>Disabled</p></td>
<td align="left" valign="top" scope="row"><p>Enabled</p></td>
<td align="left" valign="top" scope="row"><p>Enabled</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>HADB</p></td>
<td align="left" valign="top" scope="row"><p>Not available</p></td>
<td align="left" valign="top" scope="row"><p>Not available</p></td>
<td align="left" valign="top" scope="row"><p>Available</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Load balancing</p></td>
<td align="left" valign="top" scope="row"><p>Not available</p></td>
<td align="left" valign="top" scope="row"><p>Available</p></td>
<td align="left" valign="top" scope="row"><p>Available</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Node
agents</p></td>
<td align="left" valign="top" scope="row"><p>Not available</p></td>
<td align="left" valign="top" scope="row"><p>Available</p></td>
<td align="left" valign="top" scope="row"><p>Available</p></td>
</tr>
</table>

<a name="geomm"></a><h4>Cluster</h4>
<p>A cluster is a named collection of server instances sharing the same set
of applications, resources, and configuration information. A server instance can belong to exactly
one cluster. A cluster facilitates server instance load-balancing through distribution of a load
across multiple machines. A cluster facilitates high availability through instance-level failover. From an
administrative perspective, a cluster represents a virtualized entity in which operations on a cluster
(e.g. deployment of an application) act on all instances that make up the
cluster.</p><p>Horizontal scaling is achieved by adding Enterprise Server instances to a cluster, thereby
increasing the capacity of the system. It is possible to add Enterprise Server
instances to a cluster without disrupting service. The HTTP, RMI/IIOP, and JMS load
balancing systems distribute requests to healthy Enterprise Server instances in the cluster.</p><p><b>High Availability -</b> Availability<a name="indexterm-4"></a> allows for failover protection of Enterprise Server instances in a cluster.
If one application server instance goes down, another Enterprise Server instance takes over
the sessions that were assigned to the unavailable server. Session information is stored
using the session replication feature or by using the high-availability database (HADB). HADB supports
the persistence of HTTP sessions and stateful session beans.</p>

<a name="geomg"></a><h4>Node Agent</h4>
<p>A lightweight agent (e.g. hosting a JMX runtime only) is required on each
node in the domain to facilitate remote lifecycle management of instances. Its primary
purpose is to start, stop, and create server instances as instructed by the
DAS. The Node Agent also acts as a watchdog and restarts failed
processes. Like the DAS, the Node Agent should only be required for certain
administrative operations and should not be expected to be highly available. However, the Node
Agent is an &#8220;always on&#8221; component, and must be configured to be started
by the native O/S node bootstrap (e.g. Solaris/Linux <tt>inetd</tt>, or as a
Windows service). A Node Agent is not required for the DAS. </p>

<a name="geolm"></a><h4>Server Instance</h4>
<p>The server instance is a single Java EE compatible Java Virtual Machine hosting
an Enterprise Server on a single node. Each server instance has a
unique name in the domain. A clustered server instance is a member of
a cluster and receives all of its applications, resources, and configuration from its
parent cluster; ensuring that all instances in the cluster are homogeneous. An unclustered server
instance does not belong to a cluster and as such has an
independent set of applications, resources, and configuration. The following figure shows an application server
instance in detail. The application server instance is a building block in the
clustering, load balancing, and session persistence features of the Enterprise Server.</p><a name="geonp"></a><h6>Figure&#160;1-1 Enterprise Server Instance</h6><img src="figures/app-serv-deploy.gif" alt="Figure shows server instance features and how they communicate with various clients, databases, and other servers and systems." width="585" height="592"></img><p>The Sun GlassFish Enterprise Server creates one application server instance, called <tt>server</tt>, at
the time of installation. For many users, one application server instance meets their
needs. However, depending upon your environment, you might want to create one or
more additional application server instances. For example, in a development environment you can
use different application server instances to test different Enterprise Server configurations, or to compare
and test different application deployments. Because you can easily add or delete an
application server instance, you can use them to create temporary sandbox area for
experimentation purposes.</p><p>In addition, for each application server instance, you can also create virtual servers.
Within a single installed application server instance you can offer companies or individuals
domain names, IP Addresses, and some administration capabilities. For the users, it is
almost as if they have their own web server, without the hardware and
basic server maintenance. These virtual servers do not span application server instances. For
more information about virtual servers, see <a href="p16.html">Chapter&#160;13, Configuring the HTTP Service</a>.</p><p>In operational deployments, for many purposes you can use virtual servers instead of
multiple application server instances. However, if virtual servers do not meet your needs,
you can also use multiple application server instances. On stopping, application server instance
stops accepting new connections, then waits for all outstanding connections to complete. If
your machine crashes or is taken offline, the server quits and any requests
it was servicing may be lost. </p>

<a name="ablci"></a><h5>Ports in the Enterprise Server</h5>
<p>The following table describes the port listeners<a name="indexterm-5"></a> of the Enterprise Server.</p><h6>Table&#160;1-2 Enterprise Server Listeners that Use Ports</h6><table><col width="16%"><col width="16%"><col width="66%"><tr><th align="left" valign="top" scope="column"><p>Listener 
           
           </p></th>
<th align="left" valign="top" scope="column"><p>Default
Port Number          
           
  </p></th>
<th align="left" valign="top" scope="column"><p>Description         
           
   </p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p>Administrative server</p></td>
<td align="left" valign="top" scope="row"><p>4848</p><p></p></td>
<td align="left" valign="top" scope="row"><p>A domain&#8217;s administrative server is accessed by the
Admin Console and the <tt>asadmin</tt> utility. For the Admin Console, specify the port number
in the URL of the browser. When executing an <tt>asadmin</tt> command remotely, specify
the port number with the --port option.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>HTTP</p></td>
<td align="left" valign="top" scope="row"><p>8080</p></td>
<td align="left" valign="top" scope="row"><p>The server listens for HTTP requests
on a port. To access deployed Web applications and services, clients connect to
this port.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>HTTPS</p></td>
<td align="left" valign="top" scope="row"><p>8181</p></td>
<td align="left" valign="top" scope="row"><p>Web applications configured for secure communications listen on a separate port.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>IIOP</p></td>
<td align="left" valign="top" scope="row"><p>3700</p></td>
<td align="left" valign="top" scope="row"><p>Remote clients
of enterprise beans (EJB components) access the beans through the IIOP listener.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>IIOP, SSL</p></td>
<td align="left" valign="top" scope="row"><p>3820
</p></td>
<td align="left" valign="top" scope="row"><p>Another port is used by the IIOP listener configured for secure communications.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>IIOP,
SSL and mutual authentication</p></td>
<td align="left" valign="top" scope="row"><p>3920 </p></td>
<td align="left" valign="top" scope="row"><p>Another port is used by the IIOP listener
configured for mutual (client and server) authentication.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIP</p></td>
<td align="left" valign="top" scope="row"><p>5060</p></td>
<td align="left" valign="top" scope="row"><p>The server listens for SIP requests on
a port.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>SIPS</p></td>
<td align="left" valign="top" scope="row"><p>5061</p></td>
<td align="left" valign="top" scope="row"><p>SIP/converged applications configured for secure communications listen on a separate port.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>JMX_ADMIN</p></td>
<td align="left" valign="top" scope="row"><p>8686</p></td>
<td align="left" valign="top" scope="row"></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p>JMS</p></td>
<td align="left" valign="top" scope="row"><p>7676</p></td>
<td align="left" valign="top" scope="row"></td>
</tr>
</table>

<a name="ghyql"></a><h3>Basic Enterprise Server Commands</h3>
<p>Administration of the Enterprise Server includes tasks such as creation, configuration, control and
management of domains, clusters, node agents, and server instances. This section contains the
following topics:</p>
<ul><li><p><a href="#gemyf">Creating a Domain</a></p></li>
<li><p><a href="#ablbd">Deleting a Domain</a></p></li>
<li><p><a href="#ablbe">Listing Domains</a></p></li>
<li><p><a href="#ablbf">Starting the Domain</a></p></li>
<li><p><a href="#ablbg">Starting the Default Domain on Windows</a></p></li>
<li><p><a href="#ablbi">Stopping the Domain</a></p></li>
<li><p><a href="#ablbk">Stopping the Default Domain on Windows</a></p></li>
<li><p><a href="#ablbh">Restarting the Domain</a></p></li>
<li><p><a href="#geopj">Creating a Cluster</a></p></li>
<li><p><a href="#geora">Starting a Cluster</a></p></li>
<li><p><a href="#georb">Stopping a Cluster</a></p></li>
<li><p><a href="#georz">Creating a Node Agent</a></p></li>
<li><p><a href="#georw">Starting a Node Agent</a></p></li>
<li><p><a href="#geosq">Stopping a Node Agent</a></p></li>
<li><p><a href="#geosl">Starting an Instance</a></p></li>
<li><p><a href="#georq">Stopping an Instance</a></p></li>
<li><p><a href="#georc">Restarting an Instance</a></p></li>
<li><p><a href="#ablbl">Recreating the Domain Administration Server</a></p></li></ul>


<a name="gemyf"></a><h4>Creating a Domain</h4>
<a name="indexterm-6"></a><p><a name="indexterm-7"></a>Domains are created using the <tt>create-domain</tt> command. The following example command creates a domain
named <tt>mydomain</tt>. The administration server listens on port 5000 and the administrative user
name is <tt>admin</tt>. The command prompts for the administrative and master passwords.</p><pre>$ asadmin create-domain --adminport 5000 --adminuser admin mydomain</pre><p>To start the Admin Console for <tt>mydomain</tt> domain, in a browser, enter the
following URL:</p><pre>http://<i>hostname</i>:5000</pre><p>In Enterprise Server 9.1, every domain has a profile associated with it. For
information on profiles, see <a href="#gelvk">Usage Profiles</a>. You can choose the profile of a domain
only during creation. Use the <tt>--profile</tt> option with the <tt>create-domain</tt> command to specify
a profile for the domain. If you do not use the <tt>--profile</tt>
option to explicitly specify a profile, the default profile is associated with the
domain. The <tt>AS_ADMIN_PROFILE</tt> variable in the <tt>asadminenv.conf</tt> file defines the default profile. </p>
<hr><p><b>Caution - </b>Do not create an enterprise domain unless you have HADB and the Network
Security Services (NSS) keystore. You will not be able to start an enterprise
domain unless you have HADB and NSS.</p>
<hr>
<p>For the preceding <tt>create-domain</tt> example, the domain&#8217;s log files, configuration files, and deployed
applications now reside in the following directory:</p><p><i>domain-root-dir</i><tt>/mydomain</tt></p><p>To create the domain&#8217;s directory in another location, specify the <tt>--domaindir</tt> option. For
the full syntax of the command, type <tt>asadmin help create-domain</tt> or the <a href="http://docs.sun.com/doc/820-4332/create-domain-1?a=view"><tt>create-domain</tt>(1)</a>.</p>

<a name="ablbd"></a><h4>Deleting a Domain</h4>
<p>Domains are deleted using the <tt>asadmin delete-domain</tt> <a name="indexterm-8"></a>command. Only the operating system user (or
root) who can administer the domain can execute this command successfully. To delete
a domain named <tt>mydomain</tt>, for example, type the following command:</p><pre>$ asadmin delete-domain mydomain</pre>

<a name="ablbe"></a><h4>Listing Domains</h4>
<p>The domains created on a machine can be found using the <tt>asadmin list-domains</tt>
<a name="indexterm-9"></a> command. To list the domains in the default <i>domain-root-dir</i> directory, type this
command:</p><pre>$ asadmin list-domains</pre><p>To list domains that were created in other directories, specify the <tt>--domaindir</tt>
option.</p>

<a name="ablbf"></a><h4>Starting the Domain</h4>
<p>When starting a domain, the administration server and application server instance are started.
Once the application server instance is started it runs constantly, listening for and
accepting requests. Each domain must be started separately.</p><p>To start a domain, type the <tt>asadmin start-domain</tt> <a name="indexterm-10"></a> command and specify the domain
name. For example, to start the default domain (<tt>domain1</tt>), type the following:</p><pre>$ asadmin start-domain --user admin domain1</pre><p>If there is only one domain, omit the domain name. For the
full command syntax, type <tt>asadmin help start-domain</tt>. If the password data is omitted, you are prompted
to supply it.</p>

<a name="ablbg"></a><h4>Starting the Default Domain on Windows</h4>
<p>From the Windows Start Menu, select Programs -> Sun Microsystems -> Enterprise
Server -> Start Admin Server.</p>

<a name="ablbi"></a><h4>Stopping the Domain</h4>
<p>Stopping a domain shuts down its administration server and application server instance. When
stopping a domain, the server instance stops accepting new connections and then waits
for all outstanding connections to complete. This process takes a few seconds because
the server instance must complete its shutdown process. While the domain is stopped,
the Admin Console or most <tt>asadmin</tt> commands cannot be used.</p><p>To stop a domain, type the <tt>asadmin stop-domain</tt> <a name="indexterm-11"></a> command and specify the domain
name. For example, to stop the default domain (<tt>domain1</tt>), type the following:</p><pre>$ asadmin stop-domain domain1</pre><p>If there is only one domain, then the domain name is optional.
For the full syntax, type <tt>asadmin help stop-domain</tt>.</p><p>Consult the Admin Console online help to stop the domain through the
Admin Console.</p>

<a name="ablbk"></a><h4>Stopping the Default Domain on Windows</h4>
<p>From the Start menu select Programs -> Sun Microsystems -> Enterprise Server-> Stop
Admin Server.</p>

<a name="ablbh"></a><h4>Restarting the Domain</h4>
<p>Restarting the server is the same as<a name="indexterm-12"></a> restarting the domain. To restart
the domain or server, stop and start the domain.</p>

<a name="geopj"></a><h4>Creating a Cluster</h4>
<p>A cluster is created using the <tt>create-cluster</tt> command. The following example creates a
cluster named <tt>mycluster</tt>. The administration server host is <tt>myhost</tt>, the server port is <tt>1234</tt>,
and the administrative username is <tt>admin</tt>. The command prompts for the administrative passwords.</p><pre>$ asadmin create-cluster --host myhost --port 1234 --user admin mycluster</pre><p>For the full syntax, type <tt>asadmin help create-cluster</tt>.</p>

<a name="geora"></a><h4>Starting a Cluster</h4>
<p>A cluster is started using the <tt>start-cluster</tt> command. The following example starts the
cluster named <tt>mycluster</tt>. The command prompts for the administrative passwords.</p><pre>$ asadmin start-cluster --host myhost --port 1234 --user admin mycluster</pre><p>For the full syntax, type <tt>asadmin help start-cluster</tt>.</p>

<a name="georb"></a><h4>Stopping a Cluster</h4>
<p>A cluster is stopped using the <tt>stop-cluster</tt> command. The following example stops the
cluster named <tt>mycluster</tt>. The command prompts for the administrative passwords.</p><pre>$ asadmin stop-cluster --host myhost --port 1234 --user admin mycluster</pre><p><tt>myhost</tt> is the administrative server host, <tt>1234</tt> is the administrative port, <tt>admin</tt> is
the administrative username.</p><p>For the full syntax, type <tt>asadmin help stop-cluster</tt>. When a cluster is stopped, all the
server instances in the cluster get stopped. A cluster without instances cannot be
stopped.</p>

<a name="georz"></a><h4>Creating a Node Agent</h4>
<p>A node agent is created using the<tt> create-node-agent</tt> command. The following example creates node
agent named <tt>mynodeagent</tt>. The administration server host is <tt>myhost</tt>, the administration server port is
<tt>1234</tt>, and the administrative username is <tt>admin</tt>. The command normally prompts for
the administrative passwords; however, if the <tt>--savemasterpassword</tt> option is not specified or false, the
command does not prompt for the administrative passwords.</p><pre>$ asadmin create-node-agent --host myhost --port 1234 --user admin mynodeagent</pre><p>For the full syntax, type <tt>asadmin help create-node-agent</tt>.</p>

<a name="georw"></a><h4>Starting a Node Agent</h4>
<p>A node agent is started using the<tt> start-node-agent</tt> command and specifying the node agent
name. For example, to start the node agent <tt>mynodeagent</tt>, type the following:</p><pre>$ asadmin start-node-agent --user admin mynodeagent</pre><p>For the full syntax, type <tt>asadmin help start-node-agent</tt>.</p>

<a name="geosq"></a><h4>Stopping a Node Agent</h4>
<p>A node agent is stopped using the<tt> stop-node-agent</tt> command and specifying the node agent
name. For example, to stop the node agent <tt>mynodeagent</tt>, type the following:</p><pre>$ asadmin stop-node-agent mynodeagent</pre><p>For the full syntax, type <tt>asadmin help stop-node-agent</tt>.</p>

<a name="geosl"></a><h4>Starting an Instance</h4>
<p>A server instance is started using the<tt> start-instance</tt> command. The following example starts the
server instance named <tt>myinstance</tt>. The command prompts for the administrative passwords.</p><pre>$ asadmin start-instance --host myhost --port 1234 --user admin myinstance</pre><p>The administrative server host is <tt>myhost</tt>, the administrative port is <tt>1234</tt>, the administrative
username is <tt>admin</tt>. The server instance <tt>myinstance</tt> can be clustered or standalone.</p><p>For the full syntax, type <tt>asadmin help start-instance</tt>. </p>

<a name="georq"></a><h4>Stopping an Instance</h4>
<p>A server instance is started using the <tt>stop-instance</tt> command. The following example stops
the server instance named <tt>myinstance</tt>. The command prompts for the administrative passwords.</p><pre>$ asadmin stop-instance --host myhost --port 1234 --user admin myinstance</pre><p>The administrative server host is <tt>myhost</tt>, the administrative port is <tt>1234</tt>, the administrative
username is <tt>admin</tt>. The server instance <tt>myinstance</tt> can be clustered or standalone.</p><p>For the full syntax, type <tt>asadmin help stop-instance</tt>. </p>

<a name="georc"></a><h4>Restarting an Instance</h4>
<p>To restart server instance, stop and start the instance. </p>

<a name="ablbl"></a><h4>Recreating the Domain Administration Server</h4>
<p>For mirroring purposes, and to provide a working copy of the Domain Administration
Server (DAS), you must have:</p>
<ul><li><p>One machine (machine1) that contains the original DAS.</p></li>
<li><p>A second machine (machine2) that contains a cluster with server instances running applications and catering to clients. The cluster is configured using the DAS on the first machine.</p></li>
<li><p>A third backup machine (machine3) where the DAS needs to be recreated in case the first machine crashes.</p></li></ul>

<hr><p><b>Note - </b>You must maintain a backup of the DAS from the first machine. Use
<tt>asadmin backup-domain</tt> to backup the current domain.</p>
<hr>


<a name="ablbm"></a><h5>To migrate the DAS</h5>
<p>The following steps are required to migrate the Domain Administration Server from the
first machine (machine1) to the third machine (machine3).</p><ol>
<li><b>Install the application server on the third machine just as it is installed
on the first machine.</b><p>This is required so that the DAS can be properly restored on the
third machine and there are no path conflicts.</p><ol style="list-style-type: lower-alpha">
<li><b>Install the application server administration package using the command-line (interactive) mode. To activate
the interactive command-line mode, invoke the installation program using the <tt>console</tt> option:</b><pre>./<i>bundle-filename</i> -console</pre><p>You must have root permission to install using the command-line interface.</p></li>
<li><b>Deselect the option to install default domain.</b><p>Restoration of backed up domains is only supported on two machines with same
architecture and <b>exactly</b> the same installation paths (use same <i>as-install</i> and <i>domain-root-dir</i> on both
machines).</p></li></ol></li>
<li><b>Copy the backup ZIP file from the first machine into the <i>domain-root-dir</i>
on the third machine. You can also FTP the file.</b></li>
<li><b>Execute <tt>asadmin restore-domain</tt> command to restore the ZIP file onto the third machine:</b><pre>asadmin restore-domain --filename <i>domain-root-dir</i>/sjsas_backup_v00001.zip domain1</pre><p>You can backup any domain. However, while recreating the domain, the domain name
should be same as the original.</p></li>
<li><b>Change <i>domain-root-dir</i><tt>/domain1/generated/tmp</tt> directory permissions on the third machine to match the permissions of
the same directory on first machine.</b><p>The default permissions of this directory are: <tt>?drwx------?</tt> (or 700).</p><p>For example:</p><p><tt>chmod 700</tt> <i>domain-root-dir</i><tt>/domain1/generated/tmp</tt></p><p>The example above assumes you are backing up <tt>domain1</tt>. If you are backing
up a domain by another name, you should replace <tt>domain1</tt> above with
the name of the domain being backed up.</p></li>
<li><b>Change the host values for the properties in the <tt>domain.xml</tt> file for the
third machine:</b></li>
<li><b>Update the <i>domain-root-dir</i><tt>/domain1/config/domain.xml</tt> on the third machine.</b><p>For example, search for <tt>machine1</tt> and replace it with <tt>machine3</tt>. So, you can
change:</p><pre>&#60;jmx-connector>&#60;property name=client-hostname value=machine1/>...</pre><p>to:</p><pre>&#60;jmx-connector>&#60;property name=client-hostname value=machine3/>...</pre></li>
<li><b>Change:</b><pre>&#60;jms-service... host=machine1.../></pre><p>to:</p><pre>&#60;jms-service... host=machine3.../></pre></li>
<li><b>Start the restored domain on machine3:</b><pre>asadmin start-domain --user <i>admin-user</i> --password <i>admin-password</i> domain1</pre></li>
<li><b>Change the DAS host values for properties under node agent on machine2.</b></li>
<li><b>Change <tt>agent.das.host</tt> property value in <i>as-install</i><tt>/nodeagents/</tt><b>nodeagent</b><tt>/agent/config/das.properties</tt> on machine2.</b></li>
<li><b>Restart the node agent on machine2.</b>
<hr><p><b>Note - </b>Start the cluster instances using the <tt>asadmin start-instance</tt> command to allow them to
synchronize with the restored domain.</p>
<hr>
</li></ol>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p3.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p5.html">Next</a></td>
</tr>
</table>



</body>
</html>

