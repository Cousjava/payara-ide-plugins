<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Administering User Security - Sun GlassFish Enterprise Server v3 Prelude Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-11-01">
</head>

<body>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&#160;</td>
<td><a href="p9.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p11.html">Next</a></td>
</tr>
</table>


<a name="ggnqj"></a>Chapter&#160;7<h3>Administering User Security</h3><a name="indexterm-288"></a><p>This chapter provides instructions for administering user security in the Sun GlassFish<sup>TM</sup> Enterprise Server
v3 Prelude environment by using the <tt>asadmin</tt> command-line utility. </p><p>Enterprise Server enforces its authentication and authorization policies upon realms, users, and groups.
This chapter assumes that you are familiar with security features such as authentication,
authorization, and certificates. If you are not, see <a href="p9.html">Chapter&#160;6, Administering System Security</a>.</p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ggkuk">Administering Authentication Realms</a></p></li>
<li><p><a href="#ggnxq">Administering File Users</a></p></li></ul>
<p>Instructions for accomplishing these tasks by using the Administration Console are contained in
the Administration Console online help.</p>

<a name="ggkuk"></a><h3>Administering Authentication Realms</h3>
<a name="indexterm-289"></a><a name="indexterm-290"></a><a name="indexterm-291"></a><a name="indexterm-292"></a><a name="indexterm-293"></a><p>An <b>authentication realm</b>, also called a <b>security policy domain</b> or <b>security domain</b>, is a scope over which
the Enterprise Server defines and enforces a common security policy. Enterprise Server is
preconfigured with the <tt>file</tt>, <tt>certificate</tt>, and <tt>admin-realm</tt> realms. In addition, you can set
up <tt>ldap</tt>, <tt>jdbc</tt>, <tt>solaris</tt>, or custom realms. An application can specify which
realm to use in its deployment descriptor. If the application does not specify
a realm, Enterprise Server uses its default realm (<tt>file</tt>).</p><dl><dt><tt>file</tt> realm</dt>
<dd><p><a name="indexterm-294"></a>Enterprise Server stores user credentials locally in a file named <tt>keyfile</tt>. The <tt>file</tt> realm is the initial default realm. </p></dd>
<dt><tt>admin-realm</tt> realm</dt>
<dd><p><a name="indexterm-295"></a>The <tt>admin-realm</tt> is also a <tt>file</tt> realm and stores administrator user credentials locally in a file named <tt>admin-keyfile</tt>. </p></dd>
<dt><tt>certificate</tt> realm</dt>
<dd><p><a name="indexterm-296"></a>Enterprise Server stores user credentials in a certificate database. When using the <tt>certificate</tt> realm, the server uses certificates with the HTTPS protocol to authenticate web clients.</p></dd>
<dt><tt>ldap</tt> realm</dt>
<dd><p><a name="indexterm-297"></a>Enterprise Server gets user credentials from a Lightweight Directory Access Protocol (LDAP) server such as the Directory Server. LDAP is a protocol for enabling anyone to locate organizations, individuals, and other resources such as files and devices in a network, whether on the public Internet or on a corporate intranet. Consult your LDAP server documentation for information on managing users and groups in the <tt>ldap</tt> realm.</p></dd>
<dt><tt>jdbc</tt> realm</dt>
<dd><p><a name="indexterm-298"></a>Enterprise Server gets user credentials from a database. The server uses the database information and the enabled <tt>jdbc</tt> realm option in the configuration file.</p></dd>
<dt>Custom realm</dt>
<dd><p><a name="indexterm-299"></a>You can create other repositories for user credentials, such as a relational database or third-party components. For more information on custom realms, see the Administration Console online help.</p></dd>
</dl>
<p>The Enterprise Server authentication service can govern users in multiple realms. </p><p>The following tasks and information are used to administer authentication realms:</p>
<ul><li><p><a href="#ggnca">To Create an Authentication Realm</a></p></li>
<li><p><a href="#ggngh">To List Authentication Realms</a></p></li>
<li><p><a href="#ggngf">To Delete an Authentication Realm</a></p></li>
<li><p><a href="#ggmww">To Configure a <tt>JDBC</tt> Realm</a></p></li></ul>


<a name="ggnca"></a><h4>To Create an Authentication Realm</h4><a name="indexterm-300"></a><a name="indexterm-301"></a><a name="indexterm-302"></a><p>The remote <tt>create-auth-realm</tt> command enables you to create an authentication realm.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>Create a realm by using the <a href="http://docs.sun.com/doc/820-4497/create-auth-realm-1?a=view"><tt>create-auth-realm</tt>(1)</a> command.</b></li></ol><a name="ggpjx"></a><h6>Example&#160;7-1 Creating a Realm</h6><p>The following example command creates a realm named <tt>db</tt>:</p><pre><tt><b>asadmin create-auth-realm --classname com.iplanet.ias.security.auth.realm.DB.Database --property defaultuser=admin:Password=admin db</b></tt></pre><p>Information similar to the following is displayed:</p><pre>Command create-auth-realm executed successfully.</pre><h6>See Also</h6><p>To see the full syntax and options of the command, type <tt>asadmin create-auth-realm <tt>--help</tt></tt>
at the command line.</p>

<a name="ggngh"></a><h4>To List Authentication Realms</h4><a name="indexterm-303"></a><a name="indexterm-304"></a><a name="indexterm-305"></a><a name="indexterm-306"></a><p>The remote <tt>list-auth-realms</tt> command enables you to list the existing authentication realms.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>List realms by using the <a href="http://docs.sun.com/doc/820-4497/list-auth-realms-1?a=view"><tt>list-auth-realms</tt>(1)</a> command.</b></li></ol><a name="ggpkw"></a><h6>Example&#160;7-2 Listing Realms</h6><p>The following example command lists the authentication realms on <tt>localhost</tt>:</p><pre><tt><b>asadmin list-auth-realms</b></tt></pre><p>Information similar to the following is displayed:</p><pre>db
certificate
file
admin-realm
Command list-auth-realms executed successfully.</pre><h6>See Also</h6><p>To see the full syntax and options of the command, type <tt>asadmin list-auth-realms <tt>--help</tt></tt>
at the command line.</p>

<a name="ggngf"></a><h4>To Delete an Authentication Realm</h4><a name="indexterm-307"></a><a name="indexterm-308"></a><a name="indexterm-309"></a><p>The remote <tt>delete-auth-realm</tt> command enables you to delete an existing authentication realm.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>Obtain the exact name of the realm that you are deleting.</b><p>To list the existing realms:</p><pre><tt><b>asadmin list-auth-realms</b></tt></pre></li>
<li><b>If necessary, notify users that the realm is being deleted.</b></li>
<li><b>Delete the realm by using the <a href="http://docs.sun.com/doc/820-4497/delete-auth-realm-1?a=view"><tt>delete-auth-realm</tt>(1)</a> command.</b></li>
<li><b>To apply your changes, restart Enterprise Server.</b><ol style="list-style-type: lower-alpha">
<li><b>Stop Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoch">To Stop a Domain (or Server)</a>.</p></li>
<li><b>Start Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoda">To Start a Domain (or Server)</a>.</p></li></ol></li></ol><a name="ggpjf"></a><h6>Example&#160;7-3 Deleting a Realm</h6><p>The following example command deletes an authentication realm named <tt>db</tt> <tt>localhost</tt>:</p><pre><tt><b>asadmin delete-auth-realm db</b></tt></pre><p>Information similar to the following is displayed:</p><pre>Command delete-auth-realm executed successfully.</pre><h6>See Also</h6><p>To see the full syntax and options of the command, type <tt>asadmin delete-auth-realm <tt>--help</tt></tt>
at the command line.</p>

<a name="ggmww"></a><h4>To Configure a <tt>JDBC</tt> Realm</h4><a name="indexterm-310"></a><a name="indexterm-311"></a><a name="indexterm-312"></a><p>Enterprise Server enables you to specify a user's credentials (user name and password)
in the <tt>jdbc</tt> realm instead of in the connection pool. Using the <tt>jdbc</tt>
realm instead of the connection pool prevents other applications from browsing the database
tables for user credentials.</p>
<hr><p><b>Note - </b>By default, storage of passwords as clear text is not supported in the
<tt>jdbc</tt> realm. Under normal circumstances, passwords should not be stored as clear text.</p>
<hr>
<ol>
<li><a name="ggmxh"></a><b>Create the database tables in which to store user credentials for the realm.</b><p>How you create the database tables depends on the database that you are
using.</p></li>
<li><b>Add user credentials to the database tables that you created.</b><p>How you add user credentials to the database tables depends on the
database that you are using.</p></li>
<li><a name="ggmvo"></a><b>Create a <tt>jdbc</tt> realm.</b><p>For instructions, see <a href="#ggnca">To Create an Authentication Realm</a>.</p></li>
<li><a name="ggmtc"></a><b>Modify the deployment descriptor to specify the <tt>jdbc</tt> realm.</b><p>Modify the deployment descriptor that is associated with your application.</p><p>For more information about how to specify a realm, see <a href="http://docs.sun.com/doc/820-4496/beabq?a=view">How to Configure a Realm in <i>Sun GlassFish Enterprise Server v3 Prelude Developer&#8217;s Guide</i></a>.</p></li>
<li><b>Assign security roles to users in the realm.</b><p>To assign a security role to a user, add a <tt>security-role-mapping</tt> element to the
deployment descriptor that you modified.</p></li></ol><a name="ghysu"></a><h6>Example&#160;7-4 Assigning a Security Role</h6><p>The following example shows a <tt>security-role-mapping</tt> element that assigns the security role <tt>Employee</tt>
to user <tt>Calvin</tt>:</p><pre>&#60;security-role-mapping>
    &#60;role-name>Employee&#60;/role-name>
    &#60;principal-name>Calvin&#60;/principal-name>
  &#60;/security-role-mapping></pre>

<a name="ggnxq"></a><h3>Administering File Users</h3>
<a name="indexterm-313"></a><a name="indexterm-314"></a><p>A <b>user</b> is an individual (or application program) identity that is defined in
Enterprise Server. A user who has been authenticated is sometimes called a <b>principal</b>.</p><p>As the administrator, you are responsible for integrating users into the Enterprise Server
environment so that their credentials are securely established and they are provided with
access to the applications and services that they are entitled to use.</p><p>The following tasks are used to manage users:</p>
<ul><li><p><a href="#ggocf">To Create a File User</a></p></li>
<li><p><a href="#ggoab">To List File Users</a></p></li>
<li><p><a href="#ghlgs">To List File Groups</a></p></li>
<li><p><a href="#ggoaw">To Update a File User</a></p></li>
<li><p><a href="#ggoah">To Delete a File User</a></p></li></ul>


<a name="ggocf"></a><h4>To Create a File User</h4><a name="indexterm-315"></a><a name="indexterm-316"></a><a name="indexterm-317"></a><a name="indexterm-318"></a><p>The remote <tt>create-file-user</tt> command enables you to create a new user by adding
a new entry to the <tt>keyfile</tt>. The entry includes the user name, password,
and any groups for the user. Multiple groups can be specified by separating
the groups with colons (:). </p><p> Creating a new <tt>file</tt> realm user is a dynamic event and does
not require server restart.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>If the user will belong to a particular group, list the current file
groups:</b><p><tt>asadmin list-file-groups &#8211;user admin &#8211;passwordfile passwords.txt</tt></p></li>
<li><b>Create a file user by using the <a href="http://docs.sun.com/doc/820-4497/create-file-user-1?a=view"><tt>create-file-user</tt>(1)</a> command.</b></li></ol><a name="ggpkq"></a><h6>Example&#160;7-5 Creating a User</h6><p>The following example command create user <tt>Jennifer</tt> on the default realm <tt>file</tt> (no
groups are specified):</p><pre><tt><b>asadmin create-file-user --user admin --passwordfile=c:\tmp\asadminpassword.txt Jennifer</b></tt></pre><p>Information similar to the following is displayed:</p><pre>Command create-file-user executed successfully.</pre><h6>See Also</h6><p>To see the full syntax and options of the command, type <tt>asadmin create-file-user <tt>--help</tt></tt>
at the command line.</p>

<a name="ggoab"></a><h4>To List File Users</h4><a name="indexterm-319"></a><a name="indexterm-320"></a><a name="indexterm-321"></a><a name="indexterm-322"></a><a name="indexterm-323"></a><p>The remote <tt>list-file-users</tt> command enables you to list the users that are in
the <tt>keyfile</tt>.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>List users by using the <a href="http://docs.sun.com/doc/820-4497/list-file-users-1?a=view"><tt>list-file-users</tt>(1)</a> command.</b></li></ol><a name="ggpgf"></a><h6>Example&#160;7-6 Listing File Users</h6><p>The following example command lists file users on the default <tt>file</tt> realm
file:</p><pre><tt><b>asadmin list-file-users</b></tt></pre><p>Information similar to the following is displayed:</p><pre>Jennifer
Command list-file-users executed successfully.</pre><h6>See Also</h6><p>To see the full syntax and options of the command, type <tt>asadmin list-file-users <tt>--help</tt></tt>
at the command line.</p>

<a name="ghlgs"></a><h4>To List File Groups</h4><a name="indexterm-324"></a><a name="indexterm-325"></a><a name="indexterm-326"></a><a name="indexterm-327"></a><a name="indexterm-328"></a><p>A <b>group</b> is a category of users classified by common traits, such as
job title or customer profile. For example, users of an e-commerce application might
belong to the <tt>customer</tt> group, and the big spenders might also belong to
the <tt>preferred</tt> group. Categorizing users into groups makes it easier to control the
access of large numbers of users. A group is defined for an entire
server and realm. A user can be associated with multiple groups of users.
</p><p>A group is different from a role in that a role defines
a function in an application, while a group is a set of users
who are related in some way. For example, in the personnel application there
might be groups such as <tt>full-time</tt>, <tt>part-time</tt>, and <tt>on-leave</tt>. Users in these groups
are all employees (the <tt>employee</tt> role). In addition, each user has its own
designation that defines an additional level of employment.</p><p>The remote <tt>list-file-groups</tt> command lists groups for a file user, or all file
groups if the <tt>--name</tt> option is not specified.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>List file groups by using the <a href="http://docs.sun.com/doc/820-4497/list-file-groups-1?a=view"><tt>list-file-groups</tt>(1)</a>command.</b></li></ol><a name="ghlgb"></a><h6>Example&#160;7-7 Listing Groups for a User</h6><p>The following example command lists the groups for user <tt>joesmith</tt>:</p><pre><tt><b>asadmin list-file-groups --name joesmith</b></tt></pre><p>Information similar to the following is displayed:</p><pre>staff
manager
Command list-file-groups executed successfully</pre>

<a name="ggoaw"></a><h4>To Update a File User</h4><a name="indexterm-329"></a><a name="indexterm-330"></a><a name="indexterm-331"></a><a name="indexterm-332"></a><p>The remote <tt>update-file-user</tt> command enables you to modify the information in the <tt>keyfile</tt>
for a specified user.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>Update the user information by using the <a href="http://docs.sun.com/doc/820-4497/update-file-user-1?a=view"><tt>update-file-user</tt>(1)</a> command.</b></li>
<li><b>To apply your changes, restart Enterprise Server.</b><ol style="list-style-type: lower-alpha">
<li><b>Stop Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoch">To Stop a Domain (or Server)</a>.</p></li>
<li><b>Start Enterprise Server.</b><p>For instructions, see <a href="p5.html#ggoda">To Start a Domain (or Server)</a>.</p></li></ol></li></ol><a name="ggpgh"></a><h6>Example&#160;7-8 Updating a User</h6><p>The following command updates the groups for user <tt>Jennifer</tt>:</p><pre><tt><b>asadmin update-file-user --passwordfile c:\tmp\asadminpassword.txt --groups staff:manager:engineer Jennifer</b></tt></pre><p>Information similar to the following is displayed:</p><pre>Command update-file-user executed successfully.</pre><h6>See Also</h6><p>To see the full syntax and options of the command, type <tt>asadmin update-file-user <tt>--help</tt></tt>
at the command line.</p>

<a name="ggoah"></a><h4>To Delete a File User</h4><a name="indexterm-333"></a><a name="indexterm-334"></a><a name="indexterm-335"></a><a name="indexterm-336"></a><p>The remote <tt>delete-file-user</tt> command enables you to remove a user entry from the
<tt>keyfile</tt> by specifying the user name.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote commands require a running server.</p></li>
<li><b>Obtain the exact name of the file user that you are deleting.</b><p>To list the existing file users:</p><pre><tt><b>asadmin list-file-users</b></tt></pre></li>
<li><b>Delete the user by using the <a href="http://docs.sun.com/doc/820-4497/delete-file-user-1?a=view"><tt>delete-file-user</tt>(1)</a> command.</b></li></ol><a name="ggpib"></a><h6>Example&#160;7-9 Deleting a User</h6><p>The following example command deletes user <tt>Jennifer</tt> from the default <tt>file</tt> realm:</p><pre><tt><b>asadmin delete-file-user Jennifer</b></tt></pre><p>Information similar to the following is displayed:</p><pre>Command delete-file-user executed successfully.</pre><h6>See Also</h6><p>To see the full syntax and options of the command, type <tt>asadmin delete-file-user <tt>--help</tt></tt>
at the command line.</p>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p9.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p11.html">Next</a></td>
</tr>
</table>



</body>
</html>

