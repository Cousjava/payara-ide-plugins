<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Developing Web Services - Sun GlassFish Enterprise Server v3 Prelude Developer's Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2008-10-01">
</head>

<body>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&#160;</td>
<td><a href="p9.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p11.html">Next</a></td>
</tr>
</table>


<a name="gaszn"></a>Chapter&#160;5<h3>Developing Web Services</h3><a name="indexterm-152"></a><p>This chapter describes Enterprise Server support for web services. Java<sup>TM</sup> API for
XML-Based Web Services (JAX-WS) version 2.0 is supported. This chapter contains the following sections:</p>
<ul><li><p><a href="#gbixz">Deploying a Web Service</a></p></li>
<li><p><a href="#gbixj">Web Services Registry</a></p></li>
<li><p><a href="#gbiyw">The Web Service URI, WSDL File, and Test Page</a></p></li></ul>

<hr><p><b>Note - </b>For GlassFish v3 Prelude, web services are not supported unless the optional Metro (JSR
109) add-on component is downloaded from the Update Tool. Without the Metro add-on
component, a servlet cannot be a web service endpoint, and the <tt>sun-web.xml</tt> elements
related to web services are ignored. For information about the Update Tool, see
the <a href="http://docs.sun.com/doc/820-5968"><i>Sun GlassFish Enterprise Server v3 Prelude Installation Guide</i></a>.</p>
<hr>
<p><a name="indexterm-153"></a><a name="indexterm-154"></a>For additional information about JAX-WS and web services, see <a href="http://jcp.org/aboutJava/communityprocess/pfd/jsr224/index.html">Java Specification Request (JSR) 224</a> and <a href="http://jcp.org/en/jsr/detail?id=109">JSR 109</a>.</p><p>The Fast Infoset standard specifies a binary format based on the XML Information
Set. This format is an efficient alternative to XML. For information about using
Fast Infoset, see the following links:</p>
<ul><li><p><a href="http://java.sun.com/webservices/docs/1.6/ReleaseNotes.html">Java Web Services Developer Pack 1.6 Release Notes</a></p></li>
<li><p><a href="http://java.sun.com/webservices/docs/1.6/jaxrpc/fastinfoset/manual.html">Fast Infoset in Java Web Services Developer Pack, Version 1.6</a></p></li>
<li><p><a href="http://fi.dev.java.net">Fast Infoset Project</a></p></li></ul>


<a name="gbixz"></a><h3>Deploying a Web Service</h3>
<a name="indexterm-155"></a><a name="indexterm-156"></a><p>You deploy a web service endpoint to the Enterprise Server just as you
would any servlet. After you deploy the web service, the next step is
to publish it. For more information about publishing a web service, see <a href="#gbixj">Web Services Registry</a>.</p><p>You can use the autodeployment feature to deploy a simple <a href="http://jcp.org/en/jsr/detail?id=181">JSR 181</a> annotated file.
You can compile and deploy in one step, as in the following example:</p><pre>javac -cp webservices.jar -d <i>domain-dir</i>/autodeploy MyWSDemo.java</pre>
<hr><p><b>Note - </b>For complex services with dependent classes, user specified WSDL files, or other advanced
features, autodeployment of an annotated file is not sufficient.</p>
<hr>
<p>The Sun-specific deployment descriptor files <tt>sun-web.xml</tt> and <tt>sun-ejb-jar.xml</tt> provide optional web service
enhancements in the <tt>webservice-endpoint</tt> and <tt>webservice-description</tt> elements, including a <tt>debugging-enabled</tt> subelement that enables
the creation of a test page. The test page feature is enabled by
default and described in <a href="#gbiyw">The Web Service URI, WSDL File, and Test Page</a>.<a name="indexterm-157"></a></p><p>For more information about deployment, autodeployment, and deployment descriptors, see the <a href="http://docs.sun.com/doc/820-4502"><i>Sun GlassFish Enterprise Server v3 Prelude Application Deployment Guide</i></a>. For
more information about the <tt>asadmin deploy</tt> command, see the <a href="http://docs.sun.com/doc/820-4497"><i>Sun GlassFish Enterprise Server v3 Prelude Reference Manual</i></a>.</p>

<a name="gbixj"></a><h3>Web Services Registry</h3>
<a name="indexterm-158"></a><p>You deploy a registry to the Enterprise Server just as you would any
module, except that if you are using the Administration Console, you must select
a Registry Type value. After deployment, you can configure a registry in one
of the following ways:</p>
<ul><li><p><a name="indexterm-159"></a>In the Administration Console, open the Web Services component, and select the Registry tab. For details, click the Help button in the Administration Console.</p></li>
<li><p>To configure a registry using the command line, use the following commands.</p>
<ul><li><p>Set the registry type to <tt>com.sun.appserv.registry.ebxml</tt> or <tt>com.sun.appserv.registry.uddi</tt>. Use a backslash before each period as an escape character. For example:</p><pre>asadmin create-resource-adapter-config --user adminuser 
--property com\.sun\.appserv\.registry\.ebxml=true MyReg</pre></li>
<li><p>Set any properties needed by the registry. For an ebXML registry, set the <tt>LifeCycleManagerURL</tt> and <tt>QueryManagerURL</tt> properties. In the following example, the system property <tt>REG_URL</tt> is set to <tt>http\\:\\/\\/siroe.com\\:6789\\/soar\\/registry\\/soap</tt>.</p><pre>asadmin create-connector-connection-pool --user adminuser --raname MyReg 
--connectiondefinition javax.xml.registry.ConnectionFactory --property 
LifeCycleManagerURL=${REG_URL}:QueryManagerURL=${REG_URL} MyRegCP</pre></li>
<li><p>Set a JNDI name for the registry resource. For example:</p><pre>asadmin create-connector-resource --user adminuser --poolname MyRegCP jndi-MyReg</pre></li></ul>
<p>For details on these commands, see the <a href="http://docs.sun.com/doc/820-4497"><i>Sun GlassFish Enterprise Server v3 Prelude Reference Manual</i></a>.</p></li></ul>
<p>After you deploy a web service, you can publish it to a
registry in one of the following ways:</p>
<ul><li><p><a name="indexterm-160"></a>In the Administration Console, open the Web Services component, select the web service in the listing on the General tab, and select the Publish tab. For details, click the Help button in the Administration Console.</p></li>
<li><p><a name="indexterm-161"></a><a name="indexterm-162"></a>Use the <tt>asadmin publish-to-registry</tt> command. For example:</p><pre>asadmin publish-to-registry --user adminuser --registryjndinames jndi-MyReg --webservicename my-ws#simple</pre><p>For details, see the <a href="http://docs.sun.com/doc/820-4497"><i>Sun GlassFish Enterprise Server v3 Prelude Reference Manual</i></a>.</p></li></ul>
<p>For more information about registries, see &#8220;Chapter 20: Java API for XML Registries&#8221; in
the <a href="http://java.sun.com/javaee/5/docs/tutorial/doc/index.html">Java EE 5 Tutorial</a>.</p><p>A module that accesses UDDI registries is provided with the Enterprise Server in
the <i>as-install</i><tt>/lib/install/applications/jaxr-ra</tt> directory.</p><p>You can also use the SOA registry available at <a href="http://www.sun.com/products/soa/index.jsp">http://www.sun.com/products/soa/index.jsp</a>.</p><p>For further information, see <a href="https://metro.dev.java.net/">https://metro.dev.java.net/</a>.</p>

<a name="gbiyw"></a><h3>The Web Service URI, WSDL File, and Test Page</h3>
<a name="indexterm-163"></a><a name="indexterm-164"></a><a name="indexterm-165"></a><p>Clients can run a deployed web service by accessing its service endpoint address
URI, which has the following format:</p><pre>http://<i>host</i>:<i>port</i>/<i>context-root</i>/<i>servlet-mapping-url-pattern</i></pre><p>The <i>context-root</i> is defined in the <tt>web.xml</tt> file, and can be overridden
in the <tt>sun-web.xml</tt> file. The <i>servlet-mapping-url-pattern</i> is defined in the <tt>web.xml</tt> file.</p><p>In the following example, the <i>context-root</i> is <tt>my-ws</tt> and the <i>servlet-mapping-url-pattern</i> is
<tt>/simple</tt>:</p><pre>http://localhost:8080/my-ws/simple</pre><p>You can view the WSDL file of the deployed service in a
browser by adding <tt>?WSDL</tt> to the end of the URI. For example:</p><pre>http://localhost:8080/my-ws/simple?WSDL</pre><p><a name="indexterm-166"></a>For debugging, you can run a test page for the deployed service in
a browser by adding <tt>?Tester</tt> to the end of the URL. For example:</p><pre>http://localhost:8080/my-ws/simple?Tester</pre><p><a name="indexterm-167"></a>You can also test a service using the Administration Console. Open the Web
Services component, select the web service in the listing on the General tab, and
select Test. For details, click the Help button in the Administration Console.</p>
<hr><p><b>Note - </b>The test page works only for WS-I compliant web services. This means that
the tester servlet does not work for services with WSDL files that use
RPC/encoded binding.</p>
<hr>
<p>Generation of the test page is enabled by default. You can disable the
test page for a web service by setting the value of the
<tt>debugging-enabled</tt> element in the <tt>sun-web.xml</tt> and <tt>sun-ejb-jar.xml</tt> deployment descriptor to <tt>false</tt>. For more
information, see the <a href="http://docs.sun.com/doc/820-4502"><i>Sun GlassFish Enterprise Server v3 Prelude Application Deployment Guide</i></a>.</p>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p9.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p11.html">Next</a></td>
</tr>
</table>



</body>
</html>

