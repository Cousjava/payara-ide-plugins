<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Assembling and Deploying Applications - Sun GlassFish Enterprise Server 2.1 Application Deployment Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-01-01">
</head>

<body>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&#160;</td>
<td><a href="p3.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p5.html">Next</a></td>
</tr>
</table>


<a name="beact"></a>Chapter&#160;1<h3>Assembling and Deploying Applications</h3><p>This chapter describes Sun Java<sup>TM</sup> System Enterprise Server modules and how these modules
are assembled separately or together in an application. This chapter also describes tools
for assembly and deployment.</p><p>The Enterprise Server modules and applications include Java Platform, Enterprise Edition (Java EE
platform) standard features and Enterprise Server specific features. Only Enterprise Server specific features are
described in detail in this chapter.</p><p>The following topics are presented in this chapter:</p>
<ul><li><p><a href="#beacu">Overview of Assembly and Deployment</a></p></li>
<li><p><a href="#beadm">Assembling Modules and Applications</a></p></li>
<li><p><a href="#beadu">Deploying Modules and Applications</a></p></li></ul>

<hr><p><b>Note - </b>Some topics in the documentation pertain to features that are available only in
domains that are configured to support clusters. Examples of domains that support clusters
are domains that are created with the cluster profile or the enterprise profile. For
information about profiles, see <a href="http://docs.sun.com/doc/820-4335/gelvk?a=view">Usage Profiles in <i>Sun GlassFish Enterprise Server 2.1 Administration Guide</i></a>.</p>
<hr>


<a name="beacu"></a><h3>Overview of Assembly and Deployment</h3>
<a name="indexterm-1"></a><a name="indexterm-2"></a><a name="indexterm-3"></a><p>Application assembly (also known as packaging) is the process of combining discrete components
of an application into a single unit that can be deployed to a
Java-EE-compliant application server. A package can be classified either as a module or
as a full-fledged application. This section covers the following topics:</p>
<ul><li><p><a href="#beacv">About Modules</a></p></li>
<li><p><a href="#beacw">About Applications</a></p></li>
<li><p><a href="#gatsc">Java EE Standard Annotation</a></p></li>
<li><p><a href="#beacx">Java EE Standard Descriptors</a></p></li>
<li><p><a href="#beacy">Enterprise Server Descriptors</a></p></li>
<li><p><a href="#beacz">Naming Standards</a></p></li>
<li><p><a href="#beada">Directory Structure</a></p></li></ul>


<a name="beacv"></a><h4>About Modules</h4>
<a name="indexterm-4"></a><a name="indexterm-5"></a><p>A module is a collection of one or more components that execute in
the same container type (for example, web or EJB) with annotations or deployment
descriptors of that type. One descriptor is standard, the other is optional and
Enterprise Server specific. Annotations can be used instead of standard descriptors.</p><p>Types of modules are as follows:</p>
<ul><li><p><a name="indexterm-6"></a><b>Web Application Archive (WAR)</b> &#8212; A web application is a collection of servlets, HTML pages, classes, and other resources that can be bundled and deployed to several Java EE application servers. A WAR file can consist of the following items: servlets, JavaServer Pages<sup>TM</sup> (JSP<sup>TM</sup>) files, JSP tag libraries, utility classes, static pages, client-side applets, beans, bean classes, and annotations or deployment descriptors (<tt>web.xml</tt> and <tt>sun-web.xml</tt>).</p></li>
<li><p><a name="indexterm-7"></a><b>EJB JAR File</b> &#8212; The EJB JAR file is the standard format for assembling enterprise beans. This file contains the bean classes (home, remote, local, and implementation), all of the utility classes, and annotations or deployment descriptors (<tt>ejb-jar.xml</tt> and <tt>sun-ejb-jar.xml</tt>). If the EJB component is a version 2.1 or earlier entity bean with container managed persistence, a <tt>.dbschema</tt> file and a CMP mapping descriptor, <tt>sun-cmp-mapping.xml</tt>, can be included as well.</p></li>
<li><p><a name="indexterm-8"></a><b>Application Client JAR File</b> &#8212; An application client is an Enterprise Server specific type of Java EE client. An application client supports the standard Java EE Application Client specifications, and in addition, supports direct access to the Enterprise Server. Its deployment descriptors are <tt>application-client.xml</tt> and <tt>sun-application-client.xml</tt>.</p></li>
<li><p><a name="indexterm-9"></a><b>Resource RAR File</b> &#8212; RAR files apply to J2EE CA connectors. A connector extends the EJB container to allow access to external  systems much like a device driver provides access to a peripheral device from a process hosted by an operating system. It is a portable way of allowing EJB components to access a foreign enterprise system. Each Enterprise Server connector has annotations or a Java EE XML file, <tt>ra.xml</tt>.</p></li></ul>
<p>Package definitions must be used in the source code of all modules so
the class loader can properly locate the classes after the modules have been
deployed.</p><p>Because the information in a deployment descriptor is declarative, it can be changed
without requiring modifications to source code. At run time, the Java EE server
reads this information and acts accordingly.</p><p>The Enterprise Server also supports lifecycle modules. See <a href="http://docs.sun.com/doc/820-4336/beamc?a=view">Chapter 13, Developing Lifecycle Listeners, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a> for more information.</p><p>EJB JAR, Web, and application client modules can also be deployed separately, outside
of any application. The following figure shows separately deployed EJB JAR, Web, and application
client modules. EJB components are assembled in a JAR file with annotations or
<tt>ejb-jar.xml</tt> and <tt>sun-ejb-jar.xml</tt> deployment descriptors. Web components are assembled in a WAR file
with annotations or <tt>web.xml</tt> and <tt>sun-web.xml</tt> deployment descriptors. Application client components are assembled
in a JAR file with <tt>application-client.xml</tt> and <tt>sun-application-client.xml</tt> deployment descriptors. These module types
are deployed to the Enterprise Server.</p><a name="fwfdj"></a><h6>Figure&#160;1-1 Module Assembly and Deployment</h6><img src="figures/dgdeploy3.gif" alt="Figure shows EJB, Web, and Application Client module assembly and deployment."></img>

<a name="beacw"></a><h4>About Applications</h4>
<a name="indexterm-10"></a><a name="indexterm-11"></a><p>An application is a logical collection of one or more modules tied together
by application annotations or deployment descriptors. Components can be assembled at either the
module or the application level. Components can also be deployed at either the
module or the application level.</p><p>EJB components are assembled in a JAR file with annotations or <tt>ejb-jar.xml</tt> and
<tt>sun-ejb-jar.xml</tt> deployment descriptors. Web components are assembled in a WAR file with annotations or
<tt>web.xml</tt> and <tt>sun-web.xml</tt> deployment descriptors. An application client is assembled in a JAR file
with <tt>application-client.xml</tt> and <tt>sun-application-client.xml</tt> deployment descriptors. A resource adapter is assembled in a
RAR file with a <tt>ra.xml</tt> deployment descriptor. All modules are assembled in an
EAR file and deployed to the Application Server. The following figure shows EJB
JAR, Web, application client, and connector modules in a Java EE application. </p><a name="fvyip"></a><h6>Figure&#160;1-2 Application Assembly and Deployment</h6><img src="figures/dgdeploya.gif" alt="Figure shows Java EE application assembly and deployment."></img><p>Each Java EE module has an optional Enterprise Server deployment descriptor and annotations or
a Java EE deployment descriptor. The Enterprise Server uses the annotations or deployment
descriptors to deploy the application components and to register the resources with the
Enterprise Server.</p><p>An application consists of one or more modules, an optional Enterprise Server
deployment descriptor, and annotations or a Java EE application deployment descriptor. All items are
assembled, using the Java ARchive (<tt>.jar</tt>) file format, into one file with an
extension of <tt>.ear</tt>.</p>

<a name="gatsc"></a><h4>Java EE Standard Annotation</h4>
<a name="indexterm-12"></a><p>The Enterprise Server supports applications and modules annotated according to the following specifications:</p>
<ul><li><p>JSR 250 Common Annotation Specification (<a href="http://www.jcp.org/en/jsr/detail?id=250">http://www.jcp.org/en/jsr/detail?id=250</a>)</p></li>
<li><p>JSR 181 Annotation for Web Services Specification (<a href="http://www.jcp.org/en/jsr/detail?id=181">http://www.jcp.org/en/jsr/detail?id=181</a>)</p></li>
<li><p>EJB 3.0 Specification (<a href="http://www.jcp.org/en/jsr/detail?id=220">http://www.jcp.org/en/jsr/detail?id=220</a>)</p></li></ul>
<p>The following annotation and deployment descriptor combinations are supported:</p>
<ul><li><p>Java EE applications or modules can be packaged with full Java EE 5.0 compliant standard and runtime deployment descriptors. If the standard deployment descriptors have specified the attribute <tt>metadata-complete</tt>, annotations in the application or module are ignored.</p></li>
<li><p>Java EE applications or modules can be fully annotated with metadata defined by the listed specifications. Annotation eliminates the need for Java EE standard deployment descriptors. In most cases, the Enterprise Server deployment descriptors are also optional.</p></li>
<li><p>Java EE applications or modules can be partially annotated with some deployment information in standard deployment descriptors.  In case of conflicts, deployment descriptor values supersede the annotated metadata, but a warning message is logged.</p></li></ul>
<p>To check the correctness of annotations or deployment descriptors prior to deployment, see
<a href="#beadq">The <tt>verifier</tt> Utility</a>.</p>

<a name="beacx"></a><h4>Java EE Standard Descriptors</h4>
<a name="indexterm-13"></a><a name="indexterm-14"></a><p>Java EE standard deployment descriptors are described in the Java EE specification, v5.
You can find the specification at <a href="http://java.sun.com/products/">http://java.sun.com/products/</a>. Information about the XML schemas that
define Java EE standard deployment descriptors is available at <a href="http://java.sun.com/xml/ns/javaee/">http://java.sun.com/xml/ns/javaee/</a>.</p>

<a name="beacy"></a><h4>Enterprise Server Descriptors</h4>
<a name="indexterm-15"></a><a name="indexterm-16"></a><p>The Enterprise Server uses additional, optional deployment descriptors for configuring features specific to
the Enterprise Server.</p><p>To check the correctness of these deployment descriptors prior to deployment, see <a href="#beadq">The <tt>verifier</tt> Utility</a>.</p><p>For complete descriptions of these files, see <a href="p5.html">Appendix&#160;A, Deployment Descriptor Files</a>.</p>

<a name="beacz"></a><h4>Naming Standards</h4>
<a name="indexterm-17"></a><p>Names of applications and individually deployed EJB JAR, WAR, and connector RAR modules
must be unique within an Enterprise Server domain. Modules of the same type
within an application must have unique names. In addition, for entity beans that
use CMP,<tt>.dbschema</tt> file names must be unique within an application.</p><p><a name="indexterm-18"></a>If you do not explicitly specify a name, the default name is the
first portion of the file name (without the <tt>.war</tt> or <tt>.jar</tt> extension).
Modules of different types can have the same name within an application, because
the directories holding the individual modules are named with <tt>_jar</tt>, <tt>_war</tt> and <tt>_rar</tt>
suffixes. This is the case when you use the Admin Console or the
<tt>asadmin</tt> command. See <a href="#beaeb">Tools for Deployment</a>.</p><p>You can specify a name in one of these ways:</p>
<ul><li><p>If deploying using the Admin Console, specify the name in the Application Name field.</p></li>
<li><p>If deploying using the <tt>asadmin deploy</tt> command, the default name of the application or module is the prefix of the JAR file that you are deploying. For example, for the <tt>hello.war</tt> file, the Web application name is <tt>hello</tt>. To override the default name, specify the <tt>--name</tt> option.</p></li></ul>
<p>Make sure your package and file names do not contain spaces or characters
that are illegal for your operating system.</p><p>Using a Java package-like naming scheme is recommended for module filenames, EAR filenames,
module names as found in the <tt>&#60;module-name></tt> portion of the <tt>ejb-jar.xml</tt> files,
and EJB names as found in the <tt>&#60;ejb-name></tt> portion of the <tt>ejb-jar.xml</tt> files. The
use of this package-like naming scheme ensures that name collisions do not occur.
The benefits of this naming practice apply not only to the Enterprise Server,
but to other Java EE application servers as well.</p><p><a name="indexterm-19"></a>JNDI lookup names for EJB components must also be unique. Establishing a consistent
naming convention might help. For example, appending the application name and the module
name to the EJB name is one way to guarantee unique names. In
this case, <tt>mycompany.pkging.pkgingEJB.MyEJB</tt> would be the JNDI name for an EJB in the
module <tt>pkgingEJB.jar</tt>, which is packaged in the application <tt>pkging.ear</tt>.</p><p><a name="indexterm-20"></a><a name="indexterm-21"></a>If you are writing your own JSR 88 client to deploy applications to
the Enterprise Server using the following API, the name of the application is
taken from the <tt>display-name</tt> entry in the Java EE standard deployment descriptor, because
there is no file name in this case. If the <tt>display-name</tt> entry is
not present, the Enterprise Server creates a temporary file name and uses that
name to deploy the application.</p><pre>javax.enterprise.deploy.spi.DeploymentManager.distribute(Target[], InputStream, InputStream)</pre><p>Neither the Admin Console nor the <tt>asadmin</tt> command uses this API.</p>
<hr><p><b>Note - </b>Use of the following JSR 88 API is preferred. In this case, the
name is derived from the file name as previously described.</p><pre>javax.enterprise.deploy.spi.DeploymentManager.distribute(Target[], File, File)</pre>
<hr>
<p>For more information about JSR 88, see the JSR 88 page at
<a href="http://jcp.org/en/jsr/detail?id=88">http://jcp.org/en/jsr/detail?id=88</a>.</p>

<a name="beada"></a><h4>Directory Structure</h4>
<a name="indexterm-22"></a><a name="indexterm-23"></a><p>When you deploy an application, the application is expanded from the EAR file
to an open directory structure. The directories holding the individual modules are named
with <tt>_jar</tt>, <tt>_war</tt> and <tt>_rar</tt> suffixes. If you use the <tt>asadmin deploydir</tt> command
to deploy a directory instead of an EAR file, your directory structure must
follow this same convention. Module and application directory structures follow the structure outlined in
the Java EE specification.</p>

<a name="beadm"></a><h3>Assembling Modules and Applications</h3>
<p>Assembling (or packaging) modules and applications in Enterprise Server conforms to all of
the customary Java-EE-defined specifications. The only difference is that when you assemble in
Enterprise Server, you can include optional Enterprise Server specific deployment descriptors that enhance
the functionality of the Enterprise Server. You can also package the Enterprise Server
specific deployment descriptors separately in a deployment plan; see <a href="#ablig">Using a Deployment Plan</a>.</p><p><a name="indexterm-24"></a><a name="indexterm-25"></a><a name="indexterm-26"></a>For example, when you assemble an EJB JAR module, you annotate or create
two deployment descriptor files with these names: <tt>ejb-jar.xml</tt> and <tt>sun-ejb-jar.xml</tt>. If the EJB
component is an entity bean with container-managed persistence, you can also create a
<tt>.dbschema</tt> file and a <tt>sun-cmp-mapping.xml</tt> file. For more information about <tt>sun-ejb-jar.xml</tt> and
<tt>sun-cmp-mapping.xml</tt>, see <a href="p5.html">Appendix&#160;A, Deployment Descriptor Files</a>.</p>
<hr><p><b>Note - </b><a name="indexterm-27"></a><a name="indexterm-28"></a>According to the Java EE specification, section 8.1.1.2, &#8220;Dependencies,&#8221; you cannot package utility classes
within an individually deployed EJB module. Instead, package the EJB module and utility
JAR within an application using the JAR Extension Mechanism Architecture. For other alternatives, see
<a href="http://docs.sun.com/doc/820-4336/beade?a=view">Chapter 2, Class Loaders, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>
<hr>
<p>The Enterprise Server provides these tools for assembling and verifying a module or
an application:</p>
<ul><li><p><a href="#beado">The <tt>asant</tt> Utility</a></p></li>
<li><p><a href="#beadp">The NetBeans IDE</a></p></li>
<li><p><a href="#beadq">The <tt>verifier</tt> Utility</a></p></li></ul>


<a name="beado"></a><h4>The <tt>asant</tt> Utility</h4>
<p>The <tt>asant</tt> utility can help you assemble and deploy modules and applications. For
details, see <a href="http://docs.sun.com/doc/820-4336/beaep?a=view">Chapter 3, The asant Utility, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>

<a name="beadp"></a><h4>The NetBeans IDE</h4>
<p><a name="indexterm-29"></a>You can use the NetBeans<sup>TM</sup> Integrated Development Environment (IDE) to assemble Java EE
applications and modules. The GlassFish edition of the Enterprise Server is bundled with the
NetBeans 5.5 IDE. For more information about using the NetBeans IDE, see <a href="http://www.netbeans.org">http://www.netbeans.org</a>.</p>

<a name="beadq"></a><h4>The <tt>verifier</tt> Utility</h4>
<a name="indexterm-30"></a><a name="indexterm-31"></a><p>The <tt>verifier</tt> utility validates Java EE annotations and deployment descriptors and Enterprise Server
specific deployment descriptors against their corresponding DTD or schema files. It gives errors
and warnings if a module or application is not Java EE and Enterprise
Server compliant. You can verify deployment descriptors in EAR, WAR, RAR, and JAR
files.</p><p><a name="indexterm-32"></a>The <tt>verifier</tt> tool is not simply an XML syntax verifier. Rules and interdependencies
between various elements in the deployment descriptors are verified. Where needed, user application
classes are introspected to apply validation rules.</p><p><a name="indexterm-33"></a>The <tt>verifier</tt> is integrated into Enterprise Server deployment and the <tt>asant</tt> task <a href="http://docs.sun.com/doc/820-4336/beaer?a=view">The sun-appserv-deploy Task in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>. You
can also run it as a stand-alone utility from the command line. The
<tt>verifier</tt> utility is located in the <i>as-install</i><tt>/bin</tt> directory.</p><p>You can run the <tt>verifier</tt> during Enterprise Server deployment using the Admin Console
or the <tt>asadmin deploy</tt> command with the <tt>--verify="true"</tt> option (see <a href="#beaeg">The <tt>asadmin</tt> Deployment Commands</a> and <a href="#beaeh">The Admin Console Deployment Pages</a>). In these
cases, the output of the <tt>verifier</tt> is written to the <i>tempdir</i><tt>/verifier-results/</tt> directory, where <i>tempdir</i>
is the temporary directory defined in the operating system. Deployment fails if any
failures are reported during the verification process. The <tt>verifier</tt> also logs information about verification
progress to the standard output.</p><p>For details on all the assertions tested by the <tt>verifier</tt>, see the assertions
documentation provided at <a href="http://java.sun.com/j2ee/avk/index.html">http://java.sun.com/j2ee/avk/index.html</a>.</p>
<hr><p><b>Tip - </b>Using the <tt>verifier</tt> tool can help you avoid runtime errors that are difficult
to debug.</p>
<hr>
<p>This section covers the following topics:</p>
<ul><li><p><a href="#beadr">Command-Line Syntax</a></p></li>
<li><p><a href="#beads">Ant Integration</a></p></li>
<li><p><a href="#beadt">Sample Results Files</a></p></li></ul>


<a name="beadr"></a><h5>Command-Line Syntax</h5>
<p>The <tt>verifier</tt> tool&#8217;s syntax is as follows:</p><pre>verifier [<i>options</i>] <i>file</i></pre><p>The <i>file</i> can be an EAR, WAR, RAR, or JAR file.</p><p>The following table shows the <i>options</i> for the <tt>verifier</tt> tool.</p><a name="fvyec"></a><h6>Table&#160;1-1 Verifier Options</h6><table><col width="13%"><col width="23%"><col width="63%"><tr><th align="left" valign="top" scope="column"><p>Short Form</p></th>
<th align="left" valign="top" scope="column"><p>Long Form</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-v</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--verbose</tt></p></td>
<td align="left" valign="top" scope="row"><p>Turns on
verbose mode. In verbose mode, the status of each run of each test
is displayed on the verifier console.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-d</tt> <i>output-dir</i></p></td>
<td align="left" valign="top" scope="row"><p><tt>--destdir</tt> <i>output-dir</i></p></td>
<td align="left" valign="top" scope="row"><p>Writes test results to the
<i>output-dir</i>, which must already exist. By default, the results files are created in the
current directory.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-D</tt> <i>domain-dir</i></p></td>
<td align="left" valign="top" scope="row"><p><tt>--domain</tt> <i>domain-dir</i></p></td>
<td align="left" valign="top" scope="row"><p>Specifies the absolute path to the domain directory. This
option is ignored if the <tt>-p</tt> option is used. The default domain directory is<i>as-install</i><tt>/domains/domain1</tt>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-r</tt><i>level</i></p></td>
<td align="left" valign="top" scope="row"><p><tt>--reportlevel</tt>
<i>level</i></p></td>
<td align="left" valign="top" scope="row"><p>Sets the output report <i>level</i> to one of the following values:</p>
<ul><li><p><tt>a</tt> or <tt>all</tt> - Reports all results.</p></li>
<li><p><tt>w</tt> or <tt>warnings</tt> - Reports only warning and failure results. This is the default.</p></li>
<li><p><tt>f</tt> or <tt>failures</tt> - Reports only failure results.</p></li></ul>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-t</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--timestamp</tt></p></td>
<td align="left" valign="top" scope="row"><p>Appends a timestamp
to the output file name. The format of the timestamp is yyyyMMddhhmmss.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-?</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--help</tt></p></td>
<td align="left" valign="top" scope="row"><p>Displays help
for the <tt>verifier</tt> command. If you use this option, you do not need
to specify an EAR, WAR, RAR, or JAR file.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-V</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--version</tt></p></td>
<td align="left" valign="top" scope="row"><p>Displays the <tt>verifier</tt> tool
version. If you use this option, you do not need to specify an
EAR, WAR, RAR, or JAR file.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-p</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--portability</tt></p></td>
<td align="left" valign="top" scope="row"><p>Verifies portable features only. By default, the
<tt>verifier</tt> also checks correct usage of Enterprise Server features in the <tt>sun-*.xml</tt> deployment descriptor
files.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-a</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--app</tt></p></td>
<td align="left" valign="top" scope="row"><p>Runs only the application tests.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-A</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--appclient</tt></p></td>
<td align="left" valign="top" scope="row"><p>Runs only the application client tests.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-c</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--connector</tt></p></td>
<td align="left" valign="top" scope="row"><p>Runs only the
connector tests.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-e</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--ejb</tt></p></td>
<td align="left" valign="top" scope="row"><p>Runs only the EJB tests.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-w</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--web</tt></p></td>
<td align="left" valign="top" scope="row"><p>Runs only the web module tests. </p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-s</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--webservices</tt></p></td>
<td align="left" valign="top" scope="row"><p>Runs
only the web service tests.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><p><tt>-l</tt></p></td>
<td align="left" valign="top" scope="row"><p><tt>--webservicesclient</tt></p></td>
<td align="left" valign="top" scope="row"><p>Runs only the web service client tests.</p></td>
</tr>
</table><p>For example, the following command runs the <tt>verifier</tt> on the <tt>ejb.jar</tt> file with
default settings:</p><pre>verifier ejb.jar</pre><p>The results files are <tt>ejb.jar.txt</tt> and <tt>ejb.jar.xml</tt>.</p><p>For a more complex example, the following command runs the <tt>verifier</tt> on
the <tt>ejb.jar</tt> file in portability mode displaying only failures and with a timestamp:</p><pre>verifier -p -rf -t ejb.jar</pre><p>The results files are <tt>ejb.jar</tt><i>timestamp</i><tt>.txt</tt> and <tt>ejb.jar</tt><i>timestamp</i><tt>.xml</tt>. The format of the <i>timestamp</i>
is yyyyMMddhhmmss.</p><p>If the <tt>verifier</tt> runs successfully and no verification errors occurred, a result code
of <tt>0</tt> is returned. A nonzero error code is returned if errors occurred
or the <tt>verifier</tt> fails to run.</p>

<a name="beads"></a><h5>Ant Integration</h5>
<a name="indexterm-34"></a><p>You can integrate the <tt>verifier</tt> into an Ant build file as a target
and use the Ant call feature to call the target each time an
application or module is assembled. You can use any of the arguments described
in <a href="#fvyec">Table&#160;1-1</a>. Example code for an Ant verify target is as follows:</p><pre>&#60;?xml version="1.0" encoding="iso-8859-1"?>
&#60;project name="Verifier Launcher" default="verify">
    &#60;target name="verify" description="verify using verifier script">
        &#60;exec executable="<i>as-install</i>/bin/verifier" 
                failonerror="true" vmlauncher="false">
            &#60;arg line="-d /tmp <i>path-to-app</i>"/>
        &#60;/exec>
    &#60;/target>
&#60;/project></pre>

<a name="beadt"></a><h5>Sample Results Files</h5>
<p>Here is a sample results XML file:</p><pre>&#60;static-verification>
 &#60;ejb>
     &#60;failed>
         &#60;test>
             &#60;test-name>
tests.ejb.session.TransactionTypeNullForContainerTX
            &#60;/test-name>
             &#60;test-assertion>
Session bean with bean managed transaction demarcation test
            &#60;/test-assertion>
             &#60;test-description>
For [ TheGreeter ] Error: Session Beans [ TheGreeter ] with 
[ Bean ] managed transaction demarcation should not have 
container transactions defined.
             &#60;/test-description>
         &#60;/test>
     &#60;/failed>
 &#60;/ejb>
...
&#60;/static-verification></pre><p>Here is a sample results TXT file:</p><pre>---------------------------
STATIC VERIFICATION RESULTS
---------------------------


----------------------------------
NUMBER OF FAILURES/WARNINGS/ERRORS
----------------------------------
# of Failures : 1
# of Warnings : 0
# of Errors : 0

-----------------------------
RESULTS FOR EJB-RELATED TESTS
-----------------------------

--------------
FAILED TESTS : 
--------------

Test Name : tests.ejb.ejb30.BusinessIntfInheritance
Test Assertion : A business interface must not extend javax.ejb.EJBObject 
or javax.ejb.EJBLocalObject. Please refer to EJB 3.0 Simplified API Section 
#3.2 for further information.
Test Description : For [ sessionApp#session-ejb.jar#HelloEJB ]
[ com.sun.sample.session.Hello ] extends either javax.ejb.EJBObject or 
javax.ejb.EJBLocalObject.


----------------------------------
END OF STATIC VERIFICATION RESULTS
----------------------------------</pre>

<a name="beadu"></a><h3>Deploying Modules and Applications</h3>
<p>This section describes the different ways to deploy Java EE applications and modules
to the Enterprise Server. It covers the following topics:</p>
<ul><li><p><a href="#beadv">Deployment Errors</a></p></li>
<li><p><a href="#ablgy">The Deployment Life Cycle</a></p></li>
<li><p><a href="#beadw">Deployment for Development</a></p></li>
<li><p><a href="#beaeb">Tools for Deployment</a></p></li>
<li><p><a href="#beaei">Deployment by Module or Application</a></p></li>
<li><p><a href="#gbiye">Deploying a Web Service</a></p></li>
<li><p><a href="#beaej">Deploying a WAR Module</a></p></li>
<li><p><a href="#beaek">Deploying an EJB JAR Module</a></p></li>
<li><p><a href="#beael">Deploying a Lifecycle Module</a></p></li>
<li><p><a href="#beaem">Deploying an Application Client</a></p></li>
<li><p><a href="#beaen">Deploying a J2EE CA Connector Module</a></p></li>
<li><p><a href="#beaeo">Access to Shared Frameworks</a></p></li></ul>


<a name="beadv"></a><h4>Deployment Errors</h4>
<a name="indexterm-35"></a><a name="indexterm-36"></a><p>If an error occurs during deployment, the application or module is not deployed.
If a module within an application contains an error, the entire application is
not deployed. This prevents a partial deployment that could leave the server in
an inconsistent state.</p><p>In addition, certain warning conditions allow an application to be deployed but return
a warning message to the deployment client.</p>

<a name="ablgy"></a><h4>The Deployment Life Cycle</h4>
<a name="indexterm-37"></a><p>After installing the Enterprise Server and starting a domain, you can deploy (install)
Java EE applications and modules. During deployment and as the application is changed,
an application or module can go through the following stages:</p>
<ol><li><p>Initial Deployment</p><p>Before deploying an application or module, start the domain.</p><p>Deploy (install) an application or module to a specific stand-alone server instance or cluster. Because applications and modules are packaged in archive files, specify the archive file name during deployment. The default is to deploy to the default server instance <tt>server</tt>.</p><p><a name="indexterm-38"></a>If you deploy to server instances or clusters, the application or module exists in the domain&#8217;s central repository and is referenced by any clusters or server instances you deployed to as targets.</p><p><a name="indexterm-39"></a>You can also deploy to the domain using the <tt>asadmin deploy</tt> or <tt>asadmin deploydir</tt> command or the Admin Console. In the cluster profile, the preselected deployment target is <tt>server</tt>. To deploy only to the domain, specify no target. If you deploy the application or module only to the domain, it exists in the domain&#8217;s central repository, but no server instances or clusters reference it until you add references.</p><p><a name="indexterm-40"></a><a name="indexterm-41"></a>Deployment is <b>dynamic</b>: you don&#8217;t need to restart the server instance after deploying application or module for applications to be available. If you do restart, all deployed applications and modules are still deployed and available.</p></li>
<li><p>Enabling or Disabling</p><p>By default, a deployed application or module is enabled, which means that it is runnable and can be accessed by clients if it has been deployed to an accessible server instance or cluster. To prevent access, disable the application or module. A disabled application or module is not uninstalled from the domain and can be easily enabled after deployment. For more information, see <a href="#beady">Disabling a Deployed Application or Module</a>.</p></li>
<li><p>Adding or Deleting Targets for a Deployed Application or Module</p><p><a name="indexterm-42"></a>Once deployed, the application or module exists in the central repository and can be referenced by a number of server instances and/or clusters. Initially, the server instances or clusters you deployed to as targets reference the application or module.</p><p>To change which server instances and clusters reference an application or module after it is deployed, change an application or module&#8217;s targets using the Admin Console, or change the application references using the <tt>asadmin</tt> tool. Because the application itself is stored in the central repository, adding or deleting targets adds or deletes the same version of an application on different targets. However, an application deployed to more than one target can be enabled on one and disabled on another, so even if an application is referenced by a target, it is not available to users unless it is enabled on that target.</p></li>
<li><p><a name="indexterm-43"></a><a name="indexterm-44"></a>Redeployment</p><p>To replace a deployed application or module, redeploy it. Redeploying automatically undeploys the previously deployed application or module and replaces it with the new one.</p><p>When redeploying through the Admin Console, the redeployed application or module is deployed to the domain, and all stand-alone or clustered server instances that reference it automatically receive the new version if dynamic reconfiguration is enabled. If using the <tt>asadmin deploy</tt> command to redeploy, specify <tt>domain</tt> as the target.</p><p>If an application is deployed on one target only and you are redeploying using <tt>asadmin</tt>, specify the same target during redeployment.</p><p>For production environments, perform a rolling upgrade, which upgrades the application or module without interruption in service. For more information, see <a href="http://docs.sun.com/doc/820-4341/abdjj?a=view">To Upgrade Components Without Loss of Service in <i>Sun GlassFish Enterprise Server 2.1 High Availability Administration Guide</i></a>.</p></li>
<li><p>Undeployment</p><p>To uninstall an application or module, undeploy it.</p></li></ol>


<a name="beadw"></a><h4>Deployment for Development</h4>
<p>This section covers the following topics related to deployment for development:</p>
<ul><li><p><a href="#beadx">Dynamic Deployment</a></p></li>
<li><p><a href="#beady">Disabling a Deployed Application or Module</a></p></li>
<li><p><a href="#beadz">Dynamic Reloading</a></p></li>
<li><p><a href="#beaea">Automatic Deployment</a></p></li>
<li><p><a href="#gbzce">Directory Deployment</a></p></li>
<li><p><a href="#ablig">Using a Deployment Plan</a></p></li></ul>

<hr><p><b>Note - </b><a name="indexterm-45"></a><a name="indexterm-46"></a><a name="indexterm-47"></a>You can overwrite a previously deployed application by using the <tt>--force</tt> option of <tt>asadmin deploy</tt>
or <tt>asadmin deploydir</tt> or by selecting the Redeploy button in the Admin Console. However,
you must remove a preconfigured resource before you can update it.</p>
<hr>


<a name="beadx"></a><h5>Dynamic Deployment</h5>
<a name="indexterm-48"></a><a name="indexterm-49"></a><a name="indexterm-50"></a><a name="indexterm-51"></a><p>You can deploy, redeploy, and undeploy an application or module without restarting the
server instances. This is called dynamic deployment. Although primarily for developers, dynamic deployment
can be used in operational environments to bring new applications and modules online without
requiring a server restart. </p><p><a name="indexterm-52"></a>Whenever a redeployment is done, the sessions at that transit time become invalid.
The client must restart the session.</p>

<a name="beady"></a><h5>Disabling a Deployed Application or Module</h5>
<a name="indexterm-53"></a><a name="indexterm-54"></a><a name="indexterm-55"></a><p>You can disable a deployed application or module without removing it from the
server. Disabling an application makes it inaccessible to clients.</p><p>To disable an application or module using the <tt>asadmin disable</tt> command, see the
<a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a>.</p>

<a name="fvyje"></a><h5>To Disable an Application or Module in the Admin Console</h5>
<a name="indexterm-56"></a><ol>
<li><b>Open the Applications component.</b></li>
<li><b>Go to the page for the type of application or module. </b><p>For example, for a web application, go to the Web Applications page.</p></li>
<li><b>Click on the box to the left of the name of each
application or module you wish to disable.</b></li>
<li><b>Click on the Disable button.</b></li></ol><h6>See Also</h6><p>For details, click the Help button in the Admin Console.</p>

<a name="beadz"></a><h5>Dynamic Reloading</h5>
<a name="indexterm-57"></a><a name="indexterm-58"></a><p>If dynamic reloading is enabled (it is by default), you do not have
to redeploy an application or module when you change its code or deployment
descriptors. Simply copy the changed JSP or class files into the deployment directory
for the application or module. The server checks for changes periodically and redeploys
the application, automatically and dynamically, with the changes. This feature is available only on
the default server instance. Deployment directories are as follows:</p><p>For an application:</p><pre><i>domain-dir</i>/applications/j2ee-apps/<i>app-name</i></pre><p>For an individually deployed module:</p><pre><i>domain-dir</i>/applications/j2ee-modules/<i>module-name</i></pre><p><a name="indexterm-59"></a>Dynamic reloading is useful in a development environment, because it allows code changes
to be tested quickly. In a production environment, however, dynamic reloading might degrade performance.
In addition, whenever a reload is done, the sessions at that transit time
become invalid. The client must restart the session.</p><p>You can also use the <tt>sun-appserv-update</tt> task with the <tt>asant</tt> utility to update
an application or module. See <a href="http://docs.sun.com/doc/820-4336/beaep?a=view">Chapter 3, The asant Utility, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>

<a name="fvybc"></a><h5>To Enable Dynamic Reloading in the Admin Console</h5>
<a name="indexterm-60"></a><ol>
<li><b>To access reloading features:</b><ul>
<li><b>In the developer profile:</b><ol style="list-style-type: lower-alpha">
<li><b>Select the Application Server component.</b></li>
<li><b>Select the Advanced tab.</b></li>
<li><b>Select the Applications Configuration tab.</b></li></ol></li>
<li><b>In the cluster profile:</b><ol style="list-style-type: lower-alpha">
<li><b>Select the Stand-Alone Instances component.</b></li>
<li><b>Select the instance named <tt>server</tt> in the table.</b><p>This is the Admin Server.</p></li>
<li><b>Select the Advanced tab.</b></li></ol></li></ul></li>
<li><b>Check the Reload Enabled box to enable dynamic reloading.</b></li>
<li><b>Enter a number of seconds in the Reload Poll Interval field. </b><p>This sets the interval at which applications and modules are checked for code
changes and dynamically reloaded. The default is <tt>2</tt>.</p></li></ol><h6>See Also</h6><p>For details, click the Help button in the Admin Console.</p>

<a name="fwakh"></a><h5>To Reload Code or Deployment Descriptor Changes</h5>
<ol>
<li><b><a name="indexterm-61"></a>Create an empty file named <tt>.reload</tt> at the root of the deployed application or
module.</b><p>For an application:</p><pre><i>domain-dir</i>/applications/j2ee-apps/<i>app-name</i>/.reload</pre><p>For an individually deployed module:</p><pre><i>domain-dir</i>/applications/j2ee-modules/<i>module-name</i>/.reload</pre></li>
<li><b>Explicitly update the <tt>.reload</tt> file&#8217;s timestamp (<tt>touch .reload</tt> in UNIX) each time you make changes.</b></li></ol>

<a name="beaea"></a><h5>Automatic Deployment</h5>
<a name="indexterm-62"></a><p>Automatic deployment, also called <b>autodeployment</b>, involves copying an application or module file (JAR,
WAR, RAR, or EAR) into a special directory, where it is automatically deployed by
the Enterprise Server. To undeploy an automatically deployed application or module, simply remove
its file from the special autodeployment directory. This is useful in a development
environment, because it allows new code to be tested quickly. This feature is
available only on the default server instance.</p><p>Autodeployment of a web services JSR 181 annotated file is supported. For more
information, see <a href="http://www.jcp.org/en/jsr/detail?id=181">JSR 181</a> and <a href="http://docs.sun.com/doc/820-4336/gaszn?a=view">Chapter 6, Developing Web Services, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p><p>Autodeployment is enabled by default.</p>

<a name="fvxze"></a><h5>To Enable and Configure or to Disable Autodeployment</h5>
<ol>
<li><b>To access autodeployment features:</b><ul>
<li><b>In the developer profile:</b><ol style="list-style-type: lower-alpha">
<li><b>Select the Application Server component.</b></li>
<li><b>Select the Advanced tab.</b></li>
<li><b>Select the Applications Configuration tab.</b></li></ol></li>
<li><b>In the cluster profile:</b><ol style="list-style-type: lower-alpha">
<li><b>Select the Stand-Alone Instances component.</b></li>
<li><b>Select the instance named <tt>server</tt> in the table.</b><p>This is the Admin Server.</p></li>
<li><b>Select the Advanced tab.</b></li></ol></li></ul></li>
<li><b>Check the Auto Deploy Enabled box to enable autodeployment, or uncheck this box
to disable autodeployment.</b></li>
<li><b>Enter a number of seconds in the Auto Deploy Poll Interval field.</b><p>This sets the interval at which applications and modules are checked for code
changes and dynamically reloaded. The default is <tt>2</tt>.</p></li>
<li><b>You can change the Auto Deploy Directory. </b><p>You can enter an absolute or relative path. A relative path is relative to
<i>domain-dir</i>. The default is <i>domain-dir</i><tt>/autodeploy</tt>. </p></li>
<li><b>You can check the Verifier Enabled box to verify your deployment descriptor files.
This is optional. </b><p>For details about the <tt>verifier</tt>, see <a href="#beadq">The <tt>verifier</tt> Utility</a>.</p></li>
<li><b>Check the Precompile Enabled box to precompile any JSP files.</b></li></ol><h6>See Also</h6><p>For details, click the Help button in the Admin Console.</p>

<a name="gbzce"></a><h5>Directory Deployment</h5>
<a name="indexterm-63"></a><a name="indexterm-64"></a><a name="indexterm-65"></a><p>A directory containing an unpackaged application or module is sometimes called an exploded
directory.  To deploy a directory instead of an EAR, WAR, JAR, or
RAR file, you can do one of the following:</p>
<ul><li><p>Use the Admin Console as described in <a href="#beaeh">The Admin Console Deployment Pages</a> and enter a path to an exploded directory instead of a path to an archive file.</p></li>
<li><p>Use the <tt>asadmin deploydir</tt> command. See the <a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a>. The <tt>asadmin deploydir</tt> command is available only on the default server instance.</p></li></ul>
<p>The contents of the directory must match the contents of a corresponding Java
EE archive file. For example, if you deploy a Web application from a
directory, the contents of the directory must be the same as a corresponding
WAR file. In addition, the directories holding the individual modules must be named
with <tt>_jar</tt>, <tt>_war</tt> and <tt>_rar</tt> suffixes. For information about the required directory contents,
see the appropriate specifications.</p><p>You can change the deployment descriptor files directly in the exploded directory. 
If your environment is configured to use dynamic reloading, you can also dynamically
reload applications deployed from the directory. For more information, see <a href="#beadz">Dynamic Reloading</a>.</p>
<hr><p><b>Note - </b>On Windows, if you are deploying a directory on a mapped drive, you
must be running the Enterprise Server as the same user to which the
mapped drive is assigned, or the Enterprise Server won&#8217;t see the directory.</p>
<hr>


<a name="ablig"></a><h5>Using a Deployment Plan</h5>
<p><a name="indexterm-66"></a><a name="indexterm-67"></a>This feature is for advanced developers.</p><p>A deployment plan is an JAR file that contains only the deployment descriptors
that are specific to the Enterprise Server. The deployment plan is part of
the implementation of JSR 88. Use a deployment plan to deploy an application
or module that does not contain the deployment descriptors that are specific to
the Enterprise Server. For more information about JSR 88, see the JSR 88
page at <a href="http://jcp.org/en/jsr/detail?id=88">http://jcp.org/en/jsr/detail?id=88</a>.</p><p>To deploy using a deployment plan, specify the <tt>--deploymentplan</tt> option of the
<tt>asadmin deploy</tt> command. The following command, for example, deploys the enterprise application in the <tt>myrostapp.ear</tt>
file according to the plan specified by the <tt>mydeployplan.jar</tt> file.</p><pre>$ asadmin deploy --user admin --deploymentplan mydeployplan.jar myrostapp.ear</pre><p>In the deployment plan file for an enterprise application (EAR), the <tt>sun-application.xml</tt> file
is located at the root. The deployment descriptor for each module is stored
according to this syntax: <i>module-name.sun-dd-name</i>, where the <i>sun-dd-name</i> depends on the module type. If a
module contains a CMP mappings file, the file is named <i>module-name</i><tt>.sun-cmp-mappings.xml</tt>. A <tt>.dbschema</tt>
file is stored at the root level with each forward slash character (/)
replaced by a pound sign (#). The following listing shows the structure of
the deployment plan file for an enterprise application (EAR).</p><pre>$ jar -tvf mydeployplan.jar
420 Thu Mar 13 15:37:48 PST 2003 sun-application.xml
370 Thu Mar 13 15:37:48 PST 2003 RosterClient.war.sun-web.xml
418 Thu Mar 13 15:37:48 PST 2003 roster-ac.jar.sun-application-client.xml
1281 Thu Mar 13 15:37:48 PST 2003 roster-ejb.jar.sun-ejb-jar.xml
2317 Thu Mar 13 15:37:48 PST 2003 team-ejb.jar.sun-ejb-jar.xml
3432 Thu Mar 13 15:37:48 PST 2003 team-ejb.jar.sun-cmp-mappings.xml
84805 Thu Mar 13 15:37:48 PST 2003 team-ejb.jar.RosterSchema.dbschema</pre><p>In the deployment plan for a web module file, the deployment descriptor that
is specific to the Enterprise Server is at the root level. If a
stand-alone EJB module contains a CMP bean, the deployment plan includes the <tt>sun-cmp-mappings.xml</tt>
and <tt>.dbschema</tt> files at the root level. In the following listing, the deployment
plan describes a CMP bean.</p><pre>$ jar r -tvf myotherplan.jar
3603 Thu Mar 13 15:24:20 PST 2003 sun-ejb-jar.xml
3432 Thu Mar 13 15:24:20 PST 2003 sun-cmp-mappings.xml
84805 Thu Mar 13 15:24:20 PST 2003 RosterSchema.dbschema</pre>

<a name="beaeb"></a><h4>Tools for Deployment</h4>
<a name="indexterm-68"></a><a name="indexterm-69"></a><p>This section discusses the various tools that can be used to deploy modules
and applications. The deployment tools include:</p>
<ul><li><p><a href="#beaec">The <tt>asant</tt> Utility</a></p></li>
<li><p><a href="#beaee">JSR 88</a></p></li>
<li><p><a href="#beaeg">The <tt>asadmin</tt> Deployment Commands</a></p></li>
<li><p><a href="#beaeh">The Admin Console Deployment Pages</a></p></li></ul>


<a name="beaec"></a><h5>The <tt>asant</tt> Utility</h5>
<p>The <tt>asant</tt> utility can help you assemble and deploy modules and applications. For
details, see <a href="http://docs.sun.com/doc/820-4336/beaep?a=view">Chapter 3, The asant Utility, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>

<a name="beaee"></a><h5>JSR 88</h5>
<a name="indexterm-70"></a><a name="indexterm-71"></a><p>You can write your own JSR 88 client to deploy applications to the
Enterprise Server. For more information, see the JSR 88 page at <a href="http://jcp.org/en/jsr/detail?id=88">http://jcp.org/en/jsr/detail?id=88</a>.</p><p><a name="indexterm-72"></a>The syntax of the URI entry for the <tt>getDeploymentManager</tt> method is as follows:</p><pre>deployer:Sun:AppServer::<i>admin-host</i>:<i>admin-port</i>[:https]</pre><p>The <tt>:https</tt> is not needed by default in the developer profile and needed
by default in the cluster profile. For example:</p><pre>deployer:Sun:AppServer::localhost:4848:https</pre><p>See <a href="#beacz">Naming Standards</a> for application and module naming considerations.</p>

<a name="beaeg"></a><h5>The <tt>asadmin</tt> Deployment Commands</h5>
<p><a name="indexterm-73"></a><a name="indexterm-74"></a><a name="indexterm-75"></a><a name="indexterm-76"></a>You can use the <tt>asadmin deploy</tt> or <tt>asadmin deploydir</tt> command to deploy or undeploy applications
and individually deployed modules on local servers. For details, see <a href="#gbzce">Directory Deployment</a> and the
<i><a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a></i>. The <tt>asadmin deploydir</tt> command is available only on the default server instance.</p><p>To deploy a lifecycle module, see <a href="#beael">Deploying a Lifecycle Module</a>.</p>

<a name="beaeh"></a><h5>The Admin Console Deployment Pages</h5>
<p><a name="indexterm-77"></a><a name="indexterm-78"></a>You can use the Admin Console to deploy modules and applications to both local
and remote Enterprise Server sites. </p>

<a name="fvyfv"></a><h5>To Use the Admin Console for Deployment</h5>
<ol>
<li><b>Open the Applications component.</b></li>
<li><b>Go to the page for the type of application or module.</b><p>For example, for a web application, go to the Web Applications page. In
the developer profile, you can undeploy, enable, or disable an application or module
from the table on this page. In the cluster profile, click on the
link in the Status column to undeploy, enable, or disable an application or
module on specific targets.</p></li>
<li><b>Click on the Deploy button.</b><p><a name="indexterm-79"></a>On this page, you type the path to the WAR, JAR, EAR, or
RAR file or the exploded directory structure. You can also specify deployment settings
that vary according to the type of application or module.</p></li></ol><h6>See Also</h6><p>For details, click the Help button in the Admin Console.</p><p>To deploy a lifecycle module, see <a href="#beael">Deploying a Lifecycle Module</a>.</p><p>For more information on deploying from an exploded directory structure, see <a href="#gbzce">Directory Deployment</a>.</p>

<a name="beaei"></a><h4>Deployment by Module or Application</h4>
<p>You can deploy applications or individual modules that are independent of applications; see
<a href="#beacv">About Modules</a> and <a href="#beacw">About Applications</a>. <a name="indexterm-80"></a><a name="indexterm-81"></a>Individual module-based deployment is preferable when components need to be
accessed by:</p>
<ul><li><p>Other modules</p></li>
<li><p>Java EE applications</p></li>
<li><p>Application clients (Module-based deployment allows shared access to a bean from an application client, a servlet, or an EJB component.)</p></li></ul>
<p>Modules can be combined into an EAR file and then deployed as a
single module. This is similar to deploying the modules of the EAR independently.</p>

<a name="gbiye"></a><h4>Deploying a Web Service</h4>
<a name="indexterm-82"></a><p>You deploy a web service endpoint to the Enterprise Server just as you
would any servlet or stateless session bean (SLSB).</p><p>Web service management is fully supported in the Admin Console. If the deployed
application or module has a web service endpoint, it is detected automatically during
deployment. Once the application or module is deployed, click on the Web Service
component. The table in the right frame lists deployed web service endpoints.</p><p>You can use the <tt>--registryjndiname</tt> option of the <tt>asadmin deploy</tt> or <tt>asadmin deploydir</tt> command to publish
the web service as part of deployment, but this is optional. See <a href="#beaeb">Tools for Deployment</a>.</p><p>To deploy a JSR 181 annotated file, use the autodeployment feature. You can
compile and deploy in one step, as in the following example:</p><pre>javac -cp javaee.jar -d <i>domain-dir</i>/autodeploy MyWS.java</pre><p>For more information about JSR 181, see <a href="http://jcp.org/en/jsr/detail?id=181">http://jcp.org/en/jsr/detail?id=181</a>. For more information about autodeployment,
see <a href="#beaea">Automatic Deployment</a>.</p><p>The Sun-specific deployment descriptor files <tt>sun-web.xml</tt> and <tt>sun-ejb-jar.xml</tt> provide optional web service
enhancements in their <a href="p5.html#beayv">webservice-endpoint</a> and <a href="p5.html#beayt">webservice-description</a> elements.</p><p>For more information about web services, see <a href="http://www.jcp.org/en/jsr/detail?id=181">JSR 181</a> and <a href="http://docs.sun.com/doc/820-4336/gaszn?a=view">Chapter 6, Developing Web Services, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>

<a name="beaej"></a><h4>Deploying a WAR Module</h4>
<a name="indexterm-83"></a><a name="indexterm-84"></a><p>You deploy a WAR module as described in <a href="#beaeb">Tools for Deployment</a>. If you do
not specify a context root, the default is the name of the WAR
file without the extension.</p><p>If a web application accesses a <tt>DataSource</tt> that is not specified in a
<tt>resource-ref</tt> in <tt>sun-web.xml</tt>, or there is no <tt>sun-web.xml</tt> file, the <tt>resource-ref-name</tt> defined
in <tt>web.xml</tt> is used.  A warning message is logged recording the JNDI
name used to look up the resource.</p><p><a name="indexterm-85"></a><a name="indexterm-86"></a><a name="indexterm-87"></a>You can precompile JSP files during deployment by checking the appropriate box in
the Admin Console, or by using the <tt>--precompilejsp</tt> option of the <tt>asadmin deploy</tt> or
<tt>asadmin deploydir</tt> command. The <tt>asant</tt> tasks <tt>sun-appserv-deploy</tt> and <tt>sun-appserv-jspc</tt> also allow you to precompile
JSP files. For more information, see <a href="http://docs.sun.com/doc/820-4336/beaep?a=view">Chapter 3, The asant Utility, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p><p><a name="indexterm-88"></a><a name="indexterm-89"></a><a name="indexterm-90"></a><a name="indexterm-91"></a>You can keep the generated source for JSP files by adding the <tt>-keepgenerated</tt>
flag to the <tt>jsp-config</tt> element in <tt>sun-web.xml</tt>. If you include this property
when you deploy the WAR module, the generated source is kept in <i>domain-dir</i><tt>/generated/jsp/j2ee-apps/</tt><i>app-name</i><tt>/</tt><i>module-name</i>,
if it is in an application, or <i>domain-dir</i><tt>/generated/jsp/j2ee-modules/</tt><i>module-name</i>, if it is in an
individually deployed web module.</p><p>For more information about JSP precompilation, see <a href="p5.html#beatx">jsp-config</a> and <a href="http://docs.sun.com/doc/820-4336/beagz?a=view">Options for Compiling JSP Files in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p><p>HTTP sessions in WAR modules can be saved in a persistent store in
case a server instance fails. For more information, see <a href="http://docs.sun.com/doc/820-4336/beahe?a=view">Distributed Sessions and Persistence in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a> and the <i><a href="http://docs.sun.com/doc/820-4341"><i>Sun GlassFish Enterprise Server 2.1 High Availability Administration Guide</i></a></i>.</p>
<hr><p><b>Note - </b>After a web application is undeployed, its <tt>HttpSession</tt> information is not immediately
removed if sessions are persistent. <tt>HttpSession</tt> information is removed in the subsequent cycle, when
timed out sessions are removed. Therefore, you should disable a web application before
undeploying it if sessions are persistent.</p>
<hr>
<p>Web module context roots must be unique within a server instance.</p><p>See the<i> <a href="http://docs.sun.com/doc/820-4341"><i>Sun GlassFish Enterprise Server 2.1 High Availability Administration Guide</i></a></i> for information about load balancing.</p>

<a name="beaek"></a><h4>Deploying an EJB JAR Module</h4>
<a name="indexterm-92"></a><a name="indexterm-93"></a><p>You deploy an EJB JAR module as described in <a href="#beaeb">Tools for Deployment</a>.</p><p>If no JNDI name for the EJB JAR module is specified in
the <tt>jndi-name</tt> element immediately under the <tt>ejb</tt> element in <tt>sun-ejb-jar.xml</tt>, or there is
no <tt>sun-ejb-jar.xml</tt> file, a default, non-clashing JNDI name is derived. A warning message
is logged recording the JNDI name used to look up the EJB JAR
module.</p><p><a name="indexterm-94"></a><a name="indexterm-95"></a><a name="indexterm-96"></a><a name="indexterm-97"></a><a name="indexterm-98"></a><a name="indexterm-99"></a>You can keep the generated source for stubs and ties by adding the
<tt>-keepgenerated</tt> flag to the <tt>rmic-options</tt> attribute of the <tt>java-config</tt> element in <tt>domain.xml</tt>. If you
include this flag when you deploy the EJB JAR module, the generated source
is kept in <i>domain-dir</i><tt>/generated/ejb/j2ee-apps/</tt><i>app-name</i><tt>/</tt><i>module-name</i>, if it is in an application, or <i>domain-dir</i><tt>/generated/ejb/j2ee-modules/</tt><i>module-name</i>, if
it is in an individually deployed EJB JAR module. For more information about
the <tt>-keepgenerated</tt> flag, see the <i><a href="http://docs.sun.com/doc/820-4338"><i>Sun GlassFish Enterprise Server 2.1 Administration Reference</i></a></i>.</p><p><a name="indexterm-100"></a><a name="indexterm-101"></a>Generation of stubs and ties is performed asynchronously, so unless you request their
generation during deployment, stubs and ties are not guaranteed to be available immediately
after deployment. To generate stubs and ties during deployment, use the <tt>--retrieve</tt> option
of the <tt>asadmin deploy</tt> or <tt>asadmin deploydir</tt> command, or check the Generate RMIStubs Enabled box
in the Admin Console.</p><p>You can use the <tt>asadmin get-client-stubs</tt> command to retrieve the stubs and ties whether
or not you requested their generation during deployment. For details, see the <i><a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a></i>.</p>

<a name="beael"></a><h4>Deploying a Lifecycle Module</h4>
<a name="indexterm-102"></a><a name="indexterm-103"></a><p>For general information about lifecycle modules, see <a href="http://docs.sun.com/doc/820-4336/beamc?a=view">Chapter 13, Developing Lifecycle Listeners, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p><p>You can deploy a lifecycle module using the following tools:</p>
<ul><li><p><a name="indexterm-104"></a>In the Admin Console, open the Applications component and go to the Lifecycle Modules page. For details, click the Help button in the Admin Console.</p></li>
<li><p><a name="indexterm-105"></a>Use the <tt></tt><tt>asadmin create-lifecycle-module</tt> command. For details, see the <a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a>.</p></li></ul>

<hr><p><b>Note - </b><a name="indexterm-106"></a>If the <tt>is-failure-fatal</tt> setting is set to <tt>true</tt> (the default is <tt>false</tt>), lifecycle module
failure prevents server initialization or startup, but not shutdown or termination.</p>
<hr>


<a name="beaem"></a><h4>Deploying an Application Client</h4>
<a name="indexterm-107"></a><a name="indexterm-108"></a><a name="indexterm-109"></a><p>Deployment is necessary for application clients that communicate with EJB components or that
use Java Web Start launch support. </p><p>Java Web Start is supported for application clients and for applications that contain
application clients. It is enabled by default both in application clients and in
the Enterprise Server.</p><p>This section contains the following topics:</p>
<ul><li><p><a href="#fvyal">To Deploy an Application Client</a></p></li>
<li><p><a href="#fwahd">To Prepare Another Machine for Executing an Application Client</a></p></li>
<li><p><a href="#gavpv">Undeployment of Application Clients</a></p></li></ul>


<a name="fvyal"></a><h5>To Deploy an Application Client</h5>
<ol>
<li><b>Assemble the necessary client files. </b></li>
<li><b>Assemble the EJB components to be accessed by the client.</b></li>
<li><b>Package the client and EJB components together in an application.</b></li>
<li><b>Deploy the application as described in <a href="#beaeb">Tools for Deployment</a>.</b></li>
<li><b>If you are using the <tt>appclient</tt> script to run the application client, retrieve
the client JAR file.</b><p><a name="indexterm-110"></a><a name="indexterm-111"></a><a name="indexterm-112"></a>The client JAR file contains the ties and necessary classes for the application
client. </p><p>You can use the <tt>--retrieve</tt> option to get the client JAR file.</p><p>You can also use the <tt>asadmin get-client-stubs</tt> command to retrieve the stubs and ties whether
or not you requested their generation during deployment. For details, see the <a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a>.</p></li>
<li><b>If you are using the <tt>appclient</tt> script to run the application client, copy
the client JAR file to the client machine.</b></li></ol><h6>Next Steps</h6><p>You can execute the client on the Enterprise Server machine to test it
in one of the following ways:</p>
<ul><li><p>If Java Web Start is enabled for the application client, use the Launch link on the Application Client Modules page to launch the application client using Java Web Start.</p></li>
<li><p><a name="indexterm-113"></a>You can also use the <tt>appclient</tt> script in the <i>as-install</i><tt>/bin</tt> directory to run an application client. If you are using the default server instance, the only required option is <tt>-client</tt>, which points to the client JAR file. For example:</p><p><tt>appclient -client converterClient.jar</tt></p><p>The <tt>-xml</tt> parameter, which specifies the location of the <tt>sun-acc.xml</tt> file, is also required if you are not using the default instance.</p></li></ul>
<h6>See Also</h6><p>For more detailed information about Java Web Start, see <a href="http://docs.sun.com/doc/820-4336/beakt?a=view">Chapter 11, Developing Java Clients, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>. </p><p>For more detailed information about the <tt>appclient</tt> script, see the <a href="http://docs.sun.com/doc/820-4332"><i>Sun GlassFish Enterprise Server 2.1 Reference Manual</i></a>.</p><p>For information on deploying and running an application client that connects to an
EJB module on a Enterprise Server instance that is behind a firewall, see
<a href="http://docs.sun.com/doc/820-4336/ghbpc?a=view">Connecting to a Remote EJB Module Through a Firewall in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>

<a name="fwahd"></a><h5>To Prepare Another Machine for Executing an Application Client</h5>
<a name="indexterm-114"></a><p>If Java Web Start is enabled, the default URL for an application is
as follows:</p><pre>http://<i>host</i>:<i>port</i>/<i>context-root</i></pre><p>The default URL for a stand-alone application client module is as follows:</p><pre>http://<i>host</i>:<i>port</i>/<i>module-id</i></pre><p>If the <i>context-root</i> or <i>module-id</i> is not specified during deployment, the name
of the EAR or JAR file without the extension is used. For an
application, the relative path to the application client JAR file is also included. If
the application or module is not in EAR or JAR file format,
a <i>context-root</i> or <i>module-id</i> is generated. </p><p>Regardless of how the <i>context-root</i> or <i>module-id</i> is determined, it is written
to the server log. For details about naming, see <a href="#beacz">Naming Standards</a>.</p><p>To set a different URL for an application client, use the <tt>context-root</tt>
subelement of the <a href="p5.html#gauax">java-web-start-access</a> element in the <tt>sun-application-client.xml</tt> file.</p><p>If Java Web Start is <b>not</b> enabled for the application client, follow these
steps.</p><ol>
<li><b><a name="indexterm-115"></a>You can use the <tt>package-appclient</tt> script in the <i>as-install</i><tt>/bin</tt> directory to create the ACC
package JAR file. This is optional. </b><p><a name="indexterm-116"></a><a name="indexterm-117"></a>This JAR file is created in the <i>as-install</i><tt>/lib/appclient</tt> directory.</p></li>
<li><b>Copy the ACC package JAR file to the client machine and unjar it.</b></li>
<li><b><a name="indexterm-118"></a>Configure the <tt>sun-acc.xml</tt> file.</b><p>This file is located in the <tt>appclient/appserv/lib/appclient</tt> directory by default if you used the
<tt>package-appclient</tt> script.</p></li>
<li><b><a name="indexterm-119"></a>Configure the <tt>asenv.conf</tt> (<tt>asenv.bat</tt> on Windows) file.</b><p>This file is located in <tt>appclient/appserv/bin</tt> by default if you used the
<tt>package-appclient</tt> script.</p></li>
<li><b>Copy the client JAR file to the client machine. </b><p>You are now ready to execute the client.</p></li></ol><h6>See Also</h6><p>For more detailed information about Java Web Start and the <tt>package-appclient</tt> script,
see <a href="http://docs.sun.com/doc/820-4336/beakt?a=view">Chapter 11, Developing Java Clients, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>

<a name="gavpv"></a><h5>Undeployment of Application Clients</h5>
<p>Once application clients are downloaded, they remain on the client until removed manually.
 The Java Web Start control panel provides a simple interface you can
use to discard downloaded application clients that used Java Web Start.  When
you undeploy an application client, you can no longer use Java Web Start,
or any other mechanism, to download the application client. If you try to
launch an application client that was previously downloaded even though the server side
of the application client is no longer present, the results depend on whether the
application client has been written to tolerate such situations.</p><p>You can write your application client to detect failures in contacting server-side components
and to continue running anyway. In this case, Java Web Start can run
an undeployed application client as it is cached locally. For example, your application
client can be written to catch and recover from a <tt>javax.naming.NamingException</tt> in locating
a resource or a <tt>java.rmi.RemoteException</tt> in referring to a previously-located resource that becomes
inaccessible.</p>

<a name="beaen"></a><h4>Deploying a J2EE CA Connector Module</h4>
<a name="indexterm-120"></a><a name="indexterm-121"></a><p>You deploy a J2EE Connector Architecture (CA) connector module as described in <a href="#beaeb">Tools for Deployment</a>. After
deploying the module, you must configure it as described in <a href="http://docs.sun.com/doc/820-4336/bealk?a=view">Chapter 12, Developing Connectors, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>

<a name="beaeo"></a><h4>Access to Shared Frameworks</h4>
<a name="indexterm-122"></a><a name="indexterm-123"></a><p>When Java EE applications and modules use shared framework classes (such as utility
classes and libraries) the classes can be put in the path for the
System Classloader, the Common Classloader, or an application-specific class loader rather than in
an application or module. If you assemble a large, shared library into every
module that uses it, the result is a huge file that takes too
long to register with the server. In addition, several versions of the same
class could exist in different classloaders, which is a waste of resources. For more
information, see <a href="http://docs.sun.com/doc/820-4336/beade?a=view">Chapter 2, Class Loaders, in <i>Sun GlassFish Enterprise Server 2.1 Developer&#8217;s Guide</i></a>.</p>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p3.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p5.html">Next</a></td>
</tr>
</table>



</body>
</html>

