<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">
<head>
<!-- GenHTML revision 23224-->
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<title>Administering System Security - Sun GlassFish Enterprise Server v3 Administration Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2009-11-01">
</head>

<body>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr><td colspan="5"></td></tr>
<tr>
<td></td>
<td style="width: 60%">&#160;</td>
<td><a href="p15.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p17.html">Next</a></td>
</tr>
</table>


<a name="ablnk"></a>Chapter&#160;11<h3>Administering System Security</h3><a name="indexterm-426"></a><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ggktf">About System Security in Enterprise Server</a></p></li>
<li><p><a href="#ghgrp">Administering Passwords</a></p></li>
<li><p><a href="#ghgol">Administering Audit Modules</a></p></li>
<li><p><a href="#ablqz">Administering JSSE Certificates </a></p></li></ul>
<p>Instructions for accomplishing many of these tasks by using the Administration Console
are contained in the Administration Console online help.</p><p>Additional instructions on configuring security is contained in <a href="p17.html">Chapter&#160;12, Administering User Security</a> and <a href="p18.html">Chapter&#160;13, Administering Message Security</a>.</p><p>Information on application security is contained in <a href="http://docs.sun.com/doc/820-7695/beabg?a=view">Chapter 5, Securing Applications, in <i>Sun GlassFish Enterprise Server v3 Application Development Guide</i></a>.</p>

<a name="ggktf"></a><h3>About System Security in Enterprise Server</h3>
<a name="indexterm-427"></a><a name="indexterm-428"></a><p>Security is about protecting data, that is, how to prevent unauthorized access or
damage to data that is in storage or in transit. The Enterprise
Server is built on the Java security model, which uses a sandbox where
applications can run safely, without potential risk to systems or users. <b>System security</b> affects
all the applications in the Enterprise Server environment. </p><p>System security features include the following:</p>
<ul><li><p><a href="#ablnx">Authentication</a></p></li>
<li><p><a href="#ghlvu">Authorization</a></p></li>
<li><p><a href="#ghlql">Auditing</a></p></li>
<li><p><a href="#ghlti">Firewalls</a></p></li>
<li><p><a href="#abloj">Certificates and SSL</a></p></li>
<li><p><a href="#ablno">Tools for Managing System Security</a></p></li></ul>


<a name="ablnx"></a><h4>Authentication</h4>
<a name="indexterm-429"></a><a name="indexterm-430"></a><p><b>Authentication</b> is the way in which an entity (a user, an application, or
a component) determines that another entity is who it claims to be. An
entity uses security <b>credentials</b> to authenticate itself. The credentials might be a user
name and password, a digital certificate, or something else. Usually, servers or applications
require clients to authenticate themselves. Additionally, clients might require servers to authenticate themselves. When
authentication is bidirectional, it is called <b>mutual authentication</b>.</p><p>When an entity tries to access a protected resource, Enterprise Server uses the
authentication mechanism configured for that resource to determine whether to grant access. For
example, a user can enter a user name and password in a web
browser, and if the application verifies those credentials, the user is authenticated. The
user is associated with this authenticated security identity for the remainder of the
session.</p>

<a name="ghsqc"></a><h5>Authentication Types</h5>
<p><a name="indexterm-431"></a>Within its deployment descriptors, an application specifies the type of authentication that it
uses. Enterprise Server supports the following types of authentication:</p><dl><dt>BASIC</dt>
<dd><p>Uses the server's built-in login dialog box. The communication protocol is HTTP (SSL optional). There is no user-credentialed encryption unless using SSL.</p></dd>
<dt>FORM</dt>
<dd><p>The application provides its own custom login and error pages. The communication protocol is HTTP (SSL optional). There is no user-credentialed encryption unless using SSL.</p></dd>
<dt>CLIENT-CERT</dt>
<dd><p>The server authenticates the client using a public key certificate. The communication protocol is HTTPS (HTTP over SSL). User-credentialed encryption is SSL.</p></dd>
<dt>DIGEST</dt>
<dd><p>The server authenticates a user based on a user name and a password. The authentication is performed by transmitting the password in an encrypted form which is much more secure than the simple Base64 encoding used by BASIC authentication. The communication protocol is HTTPS.</p></dd>
</dl>


<a name="ghltx"></a><h5>Passwords</h5>
<a name="indexterm-432"></a><a name="indexterm-433"></a><p>Passwords are your first line of defense against unauthorized access to the components
and data of Enterprise Server. For Information about how to use passwords for
Enterprise Server, see <a href="#ghgrp">Administering Passwords</a>.</p>

<a name="gczen"></a><h5>Master Password and Keystores</h5>
<a name="indexterm-434"></a><a name="indexterm-435"></a><p>The <b>master password</b> is an overall shared password and is the most sensitive piece
of data in the system. It is never used for authentication and is
never transmitted over the network. You can choose to enter the master password
manually when required, or obscure it in a file. </p><p>The master password is the password for the secure keystore. When a new
application server domain is created, a new self-signed certificate is generated and stored
in the relevant keystore, which is locked using the master password (default password
<tt>changeit</tt>). If the master password is not the default (that is, you have
changed it), you are prompted for the master password. After the correct master
password is entered, the domain starts. </p>

<a name="ghgof"></a><h5>Administration Password</h5>
<a name="indexterm-436"></a><a name="indexterm-437"></a><p>The administration password, also known as the admin password, is used to invoke
the Administration Console and the <tt>asadmin</tt> utility. This password is usually set during
installation, but it can be changed. For instructions, see <a href="#ghgpu">To Change the Administration Password</a>.</p>

<a name="ablnq"></a><h5>Encoded Passwords</h5>
<a name="indexterm-438"></a><p>Files that contain encoded passwords need to be protected using file system permissions.
These files include the following:</p>
<ul><li><p><i>domain-dir</i><tt>/master-password</tt></p><p>This file contains the encoded master password and should be protected with file system permissions 600.</p></li>
<li><p>Any password file created to pass as an argument by using the <tt>--passwordfile</tt> argument to the <tt>asadmin</tt> utility should be protected with file system permissions 600.</p></li></ul>
<p>For instructions, see <a href="#ghytn">To Set a Password From a File</a>.</p>

<a name="ghgoj"></a><h5>Passsword Aliases</h5>
<a name="indexterm-439"></a><a name="indexterm-440"></a><p>To avoid storing passwords in the domain configuration file in clear text, you
can create an alias for a password. This process is also known
as <b>encrypting</b> a password. For more information, see <a href="#ghgqc">Administering Password Aliases</a>.</p>

<a name="ghlus"></a><h5>Single Sign-on</h5>
<a name="indexterm-441"></a><a name="indexterm-442"></a><p>With <b>single sign-on</b>, a user who logs in to one application becomes implicitly logged
in to other applications that require the same authentication information. Single sign-on is
based on groups. All web applications whose deployment descriptor defines the same group
and uses the same authentication method (BASIC, FORM, or CLIENT-CERT) share single sign-on.</p><p>On Enterprise Server, single sign-on is enabled by default for virtual servers, allowing
multiple applications in one virtual server  to share the user authentication state.
</p>

<a name="ghlvu"></a><h4>Authorization</h4>
<a name="indexterm-443"></a><p><b>Authorization</b>, also known as access control, is the means by which users are
granted permission to access data or perform operations. After a user is authenticated,
the user's level of authorization determines what operations the owner can perform. A
user's authorization is based on the user's role. </p>

<a name="abloh"></a><h5>Roles</h5>
<a name="indexterm-444"></a><a name="indexterm-445"></a><p>A <b>role</b> defines which applications and what parts of each application users can
access and what those users or groups can do with the applications. For
example, in a personnel application, all employees might be able to see phone
numbers and email addresses, but only managers have access to salary information. This
application would define at least two roles: <tt>employee</tt> and <tt>manager</tt>. Only users in the
<tt>manager</tt> role are allowed to view salary information.</p><p>A role is different from a group in that a role defines
a function in an application, while a group is a set of users
who are related in some way. For example, the personnel application specify groups
such as <tt>full-time</tt>, <tt>part-time</tt>, and <tt>on-leave</tt>. Users in these groups are all employees
(the <tt>employee</tt> role). In addition, each user has its own designation that defines
an additional level of employment.</p><p>Roles are defined in the deployment descriptor for the application. The application developer
or deployer maps roles to one or more groups in the deployment descriptor
for each application. When the application is being packaged and deployed, the application
specifies mappings between users, groups, and roles, as illustrated in the following figure.</p><a name="fxjfw"></a><h6>Figure&#160;11-1 Role Mapping</h6><img src="figures/security-roleMapping.gif" alt="Figure shows how users are assigned to groups, how users and groups are assigned to roles, and how applications use groups and roles." width="440" height="228"></img>

<a name="ghsqd"></a><h5>Java Authorization Contract for Containers</h5>
<a name="indexterm-446"></a><a name="indexterm-447"></a><p>Java Authorization Contract for Containers (JACC) is the part of the Java EE
specification that defines an interface for pluggable authorization providers. This enables you to
set up third-party plug-in modules to perform authorization. By default, the Enterprise Server
provides a simple, file-based authorization engine that complies with the JACC specification. You
can also specify additional third-party JACC providers. </p><p>JACC providers use the Java Authentication and Authorization Service (JAAS) APIs. JAAS enables
services to authenticate and enforce access controls upon users. JAAS implements a Java
technology version of the standard Pluggable Authentication Module (PAM) framework.</p><p>JSR 196 allows you to develop plugins at different layers. You can
define plugins that change the way new authentication mechanims are configured, such as, <tt>AuthConfigProvider</tt>
and <tt>AuthConfigFactory</tt>. You can also define new authentication mechanisms, such as <tt>ServerAuthModule</tt> and
<tt>ClientAuthModule</tt>.</p>

<a name="ghlql"></a><h4>Auditing</h4>
<a name="indexterm-448"></a><p><b>Auditing</b> is the means used to capture security-related events for the purpose of
evaluating the effectiveness of security measures. Enterprise Server uses audit modules to capture
audit trails of all authentication and authorization decisions. Enterprise Server provides a default
audit module, as well as the ability to customize the audit modules. </p><p>For administration instructions, see <a href="#ghgol">Administering Audit Modules</a>.</p>

<a name="ghlti"></a><h4>Firewalls</h4>
<a name="indexterm-449"></a><p>A <b>firewall</b> controls the flow of data between two or more networks, and
manages the links between the networks. A firewall can consist of both hardware
and software elements. The following guidelines pertain primarily to Enterprise Server:</p>
<ul><li><p>In general, firewalls should be configured so that clients can access the necessary TCP/IP ports. </p><p>For example, if the HTTP listener is operating on port 8080, configure the firewall to allow HTTP requests on port 8080 only. Likewise, if HTTPS requests are set up for port 8081, you must configure the firewalls to allow HTTPS requests on port 8081.</p></li>
<li><p>If direct Remote Method Invocations over Internet Inter-ORB Protocol (RMI-IIOP) access from the Internet to EJB modules is required, open the RMI-IIOP listener port as well. </p>
<hr><p><b>Note - </b>Opening the RMI-IIOP listener port is strongly discouraged because it creates security risks.</p>
<hr>
</li>
<li><p>In double firewall architecture, you must configure the outer firewall to allow for HTTP and HTTPS transactions. You must configure the inner firewall to allow the HTTP server plug-in to communicate with Enterprise Server behind the firewall.</p></li></ul>


<a name="abloj"></a><h4>Certificates and SSL</h4>
<a name="indexterm-450"></a><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ablok">Certificates</a></p></li>
<li><p><a href="#ablol">Certificate Chains</a></p></li>
<li><p><a href="#ablqx">Certificate Files</a></p></li>
<li><p><a href="#ablom">Secure Sockets Layer</a></p></li></ul>
<p>For administration instructions, see <a href="#ablqz">Administering JSSE Certificates </a>.</p>

<a name="ablok"></a><h5>Certificates</h5>
<a name="indexterm-451"></a><p><b>Certificates</b>, also called digital certificates, are electronic files that uniquely identify people and
resources on the Internet. Certificates also enable secure, confidential communication between two entities. There
are different kinds of certificates:</p>
<ul><li><p><b>Personal certificates</b> are used by individuals.</p></li>
<li><p><b>Server certificates</b> are used to establish secure sessions between the server and clients through secure sockets layer (SSL) technology.</p></li></ul>
<p>Certificates are based on <b>public key cryptography</b>, which uses pairs of digital keys (very long
numbers) to encrypt, or encode, information so the information can be read only
by its intended recipient. The recipient then decrypts (decodes) the information to read
it. A <b>key pair</b> contains a public key and a private key. The
owner distributes the public key and makes it available to anyone. But the
owner never distributes the private key, which is always kept secret. Because the
keys are mathematically related, data encrypted with one key can only be decrypted
with the other key in the pair.</p><p>Certificates are issued by a trusted third party called a <b>Certification Authority</b> (CA).
The CA is analogous to a passport office: it validates the certificate holder's
identity and signs the certificate so that it cannot be forged or tampered
with. After a CA has signed a certificate, the holder can present it
as proof of identity and to establish encrypted, confidential communications. Most importantly, a
certificate binds the owner's public key to the owner's identity.</p><p>In addition to the public key, a certificate typically includes information such as
the following:</p>
<ul><li><p>The name of the holder and other identification, such as the URL of the web server using the certificate, or an individual's email address</p></li>
<li><p>The name of the CA that issued the certificate</p></li>
<li><p>An expiration date</p></li></ul>
<p>Certificates are governed by the technical specifications of the X.509 format. To verify
the identity of a user in the <a name="indexterm-452"></a><tt>certificate</tt> realm, the authentication service verifies
an X.509 certificate, using the common name field of the X.509 certificate as
the principal name.</p>

<a name="ablol"></a><h5>Certificate Chains</h5>
<p>A <b>certificate chain</b> is a series of certificates issued by successive CA certificates, eventually
ending in a root CA certificate.</p><p>Web browsers are preconfigured with a set of root CA certificates that the
browser automatically trusts. Any certificates from elsewhere must come with a certificate chain
to verify their validity. </p><p>When a certificate is first generated, it is a <b>self-signed</b> certificate. A self-signed
certificate is one for which the issuer (signer) is the same as the
subject (the entity whose public key is being authenticated by the certificate). When
the owner sends a certificate signing request (CSR) to a CA, then imports
the response, the self-signed certificate is replaced by a chain of certificates. At
the bottom of the chain is the certificate (reply) issued by the CA
authenticating the subject's public key. The next certificate in the chain is one
that authenticates the CA's public key. Usually, this is a self-signed certificate (that
is, a certificate from the CA authenticating its own public key) and the
last certificate in the chain.</p><p>In other cases, the CA can return a chain of certificates. In
this situation, the bottom certificate in the chain is the same (a certificate
signed by the CA, authenticating the public key of the key entry), but
the second certificate in the chain is a certificate signed by a different
CA, authenticating the public key of the CA to which you sent the
CSR. Then, the next certificate in the chain is a certificate authenticating the
second CA's key, and so on, until a self-signed <b>root</b> certificate is reached.
Each certificate in the chain (after the first) thus authenticates the public key of
the signer of the previous certificate in the chain.</p>

<a name="ablqx"></a><h5>Certificate Files</h5>
<a name="indexterm-453"></a><a name="indexterm-454"></a><a name="indexterm-455"></a><a name="indexterm-456"></a><a name="indexterm-457"></a><p>During Enterprise Server installation, a certificate is generated in Java Secure Socket Extension
(JSSE)  format suitable for internal testing. By default, Enterprise Server stores its
certificate information in certificate databases in the <i>domain-dir</i><tt>/config</tt> directory:</p><dl><dt>Keystore file</dt>
<dd><p>The <tt>key3.db</tt> file contains Enterprise Server certificate, including its private key. The keystore file is protected with a password.</p><p>Each keystore entry has a unique alias. After installation, the Enterprise Server keystore has a single entry with an alias of <tt>s1as</tt>.</p></dd>
<dt>Truststore file</dt>
<dd><p>The <tt>cert8.db</tt> file contains the Enterprise Server trusted certificates, including public keys for other entities. For a trusted certificate, the server has confirmed that the public key in the certificate belongs to the certificate's owner. Trusted certificates generally include those of CAs.</p></dd>
</dl>
<p>By default, Enterprise Server is configured with a keystore and truststore that will
work with the example applications and for development purposes. </p>

<a name="ablom"></a><h5>Secure Sockets Layer</h5>
<a name="indexterm-458"></a><p><b>Secure Sockets Layer</b> (SSL) is the most popular standard for securing Internet communications and transactions.
Secure web applications use HTTPS (HTTP over SSL). The HTTPS protocol uses certificates to
ensure confidential and secure communications between server and clients. In an SSL connection,
both the client and the server encrypt data before sending it. Data is
decrypted upon receipt.</p><p>When a Web browser (client) wants to connect to a secure site,
an <b>SSL handshake</b> happens, like this:</p>
<ol><li><p>The browser sends a message over the network requesting a secure session (typically, by requesting a URL that begins with <tt>https</tt> instead of <tt>http</tt>).</p></li>
<li><p>The server responds by sending its certificate (including its public key).</p></li>
<li><p>The browser verifies that the server's certificate is valid and is signed by a CA whose certificate is in the browser's database (and who is trusted). It also verifies that the CA certificate has not expired.</p></li>
<li><p>If the certificate is valid, the browser generates a one time, unique <b>session</b> <b>key</b> and encrypts it with the server's public key. The browser then sends the encrypted session key to the server so that they both have a copy.</p></li>
<li><p>The server decrypts the message using its private key and recovers the session key.</p></li></ol>
<p>After the handshake, the client has verified the identity of the Web site,
and only the client and the Web server have a copy of
the session key. From this point forward, the client and the server use
the session key to encrypt all their communications with each other. Thus, their
communications are ensured to be secure.</p><p>The newest version of the SSL standard is called Transport Layer Security (TLS).
The Enterprise Server supports the SSL 3.0 and the TLS 1.0 encryption
protocols.</p><p>To use SSL, Enterprise Server must have a certificate for each external interface
or IP address that accepts secure connections. The HTTPS service of most web
servers will not run unless a certificate has been installed. For instructions on
applying SSL to HTTP listeners, see <a href="p22.html#ggnbj">To Configure an HTTP Listener for SSL</a>.</p>

<a name="ablon"></a><h5>Ciphers</h5>
<p>A <b>cipher</b> is a cryptographic algorithm used for encryption or decryption. SSL and
TLS protocols support a variety of ciphers used to authenticate the server and
client to each other, transmit certificates, and establish session keys.</p><p>Some ciphers are stronger and more secure than others. Clients and servers can
support different cipher suites. During a secure connection, the client and the server
agree to use the strongest cipher that they both have enabled for communication,
so it is usually sufficient to enable all ciphers.</p>

<a name="abloo"></a><h5>Name-based Virtual Hosts</h5>
<p>Using name-based virtual hosts for a secure application can be problematic. This is
a design limitation of the SSL protocol itself. The SSL handshake, where the
client browser accepts the server certificate, must occur before the HTTP request is
accessed. As a result, the request information containing the virtual host name cannot
be determined prior to authentication, and it is therefore not possible to assign
multiple certificates to a single IP address.</p><p>If all virtual hosts on a single IP address need to authenticate
against the same certificate, the addition of multiple virtual hosts probably will not interfere
with normal SSL operations on the server. Be aware, however, that most browsers
will compare the server's domain name against the domain name listed in the
certificate, if any (applicable primarily to official, CA-signed certificates). If the domain names
do not match, these browsers display a warning. In general, only address-based virtual
hosts are commonly used with SSL in a production environment.</p>

<a name="ablno"></a><h4>Tools for Managing System Security</h4>
<a name="indexterm-459"></a><a name="indexterm-460"></a><p>Enterprise Server provides the following tools for managing system security:</p><dl><dt>Administration Console</dt>
<dd><p> The Administration Console is a browser-based utility used to configure security for the entire server. Tasks include managing certificates, users, groups, and realms, and performing other system-wide security tasks. For a general introduction to the Administration Console, see <a href="p4.html#ablav">Administration Console</a>.</p></dd>
<dt>The <tt>asadmin</tt> utility</dt>
<dd><p>The <tt>asadmin</tt> command-line utility performs many of the same tasks as the Administration Console. You might be able to do some things with the <tt>asadmin</tt> utility that you cannot do with the Administration Console. For a general introduction to <tt>asadmin</tt>, see <a href="p4.html#gcocs"><tt>asadmin</tt> Utility</a>.</p></dd>
<dt>The <tt>keytool</tt> utility</dt>
<dd><p>The <tt>keytool</tt> Java 2 Platform, Standard Edition (J2SE) command-line utility is used for managing digital certificates and key pairs. For more information, see <a href="#ablqz">Administering JSSE Certificates </a>.</p></dd>
<dt>The <tt>policytool</tt> utility</dt>
<dd><p>The <tt>policytool</tt> J2SE graphical utility is used for managing system-wide Java security policies. As an administrator, you rarely use <tt>policytool</tt>.</p></dd>
</dl>
<p>For more information about using <tt>keytool</tt>, <tt>policytool</tt>, and other Java security tools,
see<i> Java 2 SDK Tools and Utilities</i> at <a href="http://java.sun.com/j2se/1.4.2/docs/tooldocs/tools.html#security">http://java.sun.com/j2se/1.4.2/docs/tooldocs/tools.html#security</a>.</p>

<a name="ghgrp"></a><h3>Administering Passwords</h3>
<p>There are multiple ways to administer passwords. You can rely on administrators to
keep passwords secret and change the passwords regularly. You can set up files
for storing passwords so that <tt>asadmin</tt> subcommands can access these files rather than
having users type the commands. You can encrypt passwords by setting up aliases
so that sensitive passwords are not visible in the <tt>domain.xml</tt> file.</p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#giudi">To Change the Master Password</a></p></li>
<li><p><a href="#ghgpu">To Change the Administration Password</a></p></li>
<li><p><a href="#ghytn">To Set a Password From a File</a></p></li>
<li><p><a href="#ghgqc">Administering Password Aliases</a></p></li></ul>


<a name="giudi"></a><h4>To Change the Master Password</h4><p>The master password master gives access to the crypto store used with the
domain, be that an NSS <tt>cert8.db</tt> trust store or a Java JKS keystore.
This password is not tied to a UNIX user. This overall shared password
is the most sensitive piece of data in your system. The master
password is never used for authentication and is never transmitted over the network.
</p><p>You can choose to type the password manually when required, or to
obscure the password in a password file. If there is no password file,
you are prompted for the master password. If there is a password file,
but you want to change access to require prompting, remove the file. The
default master password is <tt>changeit</tt>.</p><p>Use the <tt>change-master-password</tt> subcommand in local mode to modify the master password.</p><p>When the master password is changed, it is re-saved in the master-password keystore,
which is a Java JCEKS type keystore.<a name="indexterm-461"></a><a name="indexterm-462"></a><a name="indexterm-463"></a><a name="indexterm-464"></a></p><h6>Before You Begin</h6><p>This subcommand will not work unless the domain is stopped. </p><ol>
<li><b>Stop the domain whose password you are changing.</b><p>See <a href="p7.html#ggoch">To Stop a Domain</a>.</p></li>
<li><b>Change the master password for the domain by using the <a href="http://docs.sun.com/doc/820-7701/change-master-password-1?a=view"><tt>change-master-password</tt>(1)</a> subcommand.</b><p>You are  prompted for the old and new passwords. All dependent items
are re-encrypted. </p></li>
<li><b>Start the domain.</b><p>See <a href="p7.html#ggoda">To Start a Domain</a>.</p></li></ol><a name="givil"></a><h6>Example&#160;11-1 Changing the Master Password</h6><p>The <tt>change-master-password</tt> subcommand is interactive in that you are prompted for the old
master password as well as the new master password. This example changes the
master password for <tt>domain44ps</tt>:</p><pre>asadmin> <tt><b>change-master-password domain44ps</b></tt></pre><p>If you have already logged into the domain using the login <a href="http://docs.sun.com/doc/820-7701/login-1?a=view"><tt>login</tt>(1)</a>
subcommand, you are prompted for the new master password:</p><pre>Please enter the new master password>
Please enter the new master password again></pre><p>If you are not logged into the domain, you are prompted for
both the old and the new master passwords:</p><pre>Please enter the master password again>
Please enter the new master password>
Please enter the new master password again></pre><p>Information similar to the following is displayed:</p>Master password changed for domain44ps<h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help change-master-password</tt> at the command line.</p>

<a name="ghgpu"></a><h4>To Change the Administration Password</h4><a name="indexterm-465"></a><a name="indexterm-466"></a><a name="indexterm-467"></a><a name="indexterm-468"></a><p>Use the <tt>change-admin-password</tt> subcommand in remote mode to change the administration password. The
default administration password is <tt>admin</tt>. You are prompted for the old and new
admin passwords, with confirmation.</p>
<hr><p><b>Note - </b>If you accepted the default <tt>admin</tt> user with no password during zip installation,
you can add a password to this user. If there is a single
user called <tt>admin</tt> that does not have a password, you are not prompted
for login information.  Any other situation requires login. </p>
<hr>
<p>Encrypting the admin password is strongly encouraged.</p><h6>Before You Begin</h6><p>If you want to change the admin password before creating an alias
for the password (encrypting), you can use the  <tt>set</tt> subcommand. For example:</p><pre>asadmin set --user admin server.jms-service.jms-host.default_JMS_host.admin-password=
<i>new_pwd</i></pre><ol>
<li><b>Ensure that the server is running. </b><p>Remote subcommands require a running server.</p></li>
<li><b>Change the admin password by using the <a href="http://docs.sun.com/doc/820-7701/change-admin-password-1?a=view"><tt>change-admin-password</tt>(1)</a> subcommand. </b></li>
<li><b>Enter the old and new admin passwords when prompted.</b></li></ol><a name="ghlac"></a><h6>Example&#160;11-2 Changing the Admin Password</h6><p>This example changes the admin password for user anonymous from <tt>adminadmin</tt> to
<tt>newadmin</tt>:</p><pre>asadmin> <tt><b>change-admin-password --user anonymous</b></tt></pre><p>You are prompted to enter the old and the new admin passwords:</p><pre>Enter admin password><tt><b>adminadmin</b></tt>
Enter new admin password><tt><b>newadmin</b></tt>
Enter new admin password again><tt><b>newadmin</b></tt></pre><p>Information similar to the following is displayed:</p><pre>Command change-admin-password executed successfully.</pre><h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help change-admin-password</tt> at the command line.</p>

<a name="ghytn"></a><h4>To Set a Password From a File</h4><a name="indexterm-469"></a><a name="indexterm-470"></a><a name="indexterm-471"></a><p>Instead of typing the password at the command line, you can access
the password for a command from a file such as <tt>passwords.txt</tt>. The <tt>--passwordfile</tt> option
of the <tt>asadmin</tt> utility takes the name of the file that contains
the passwords. The entry for a password in the file must have the
<tt>AS_ADMIN_</tt> prefix followed by the password name in uppercase letters. </p><p>The following other types of passwords can be specified: </p><pre>AS_ADMIN_MASTERPASSWORD
AS_ADMIN_USERPASSWORD
AS_ADMIN_ALIASPASSWORD</pre><ol>
<li><b>Edit the password file.</b><p>For example, to specify the password for the domain administration server (DAS), add
an entry similar to the following to the password file, where <tt>adminadmin</tt> is the
administrator password:</p><pre>AS_ADMIN_PASSWORD=adminadmin </pre></li>
<li><b>Save the password file.</b><p>You can now specify the password file in an <tt>asadmin</tt> subcommand. In This
example, <tt>passwords.txt</tt> is the file that contains the password:</p><pre>asadmin><tt><b>delete-jdbc-resource --user admin --password passwords.txt jdbc/DerbyPool</b></tt></pre></li></ol><h6>Troubleshooting</h6><p>If <tt>AS_ADMIN_PASSWORD</tt> has been exported to the global environment, specifying the <tt>--passwordfile</tt> option will
produce a warning about using the <tt>--passwordfile</tt> option. To prevent this warning situation
from happening, unset <tt>AS_ADMIN_PASSWORD</tt>. </p>

<a name="ghgqc"></a><h4>Administering Password Aliases</h4>
<a name="indexterm-472"></a><a name="indexterm-473"></a><p>A password alias is used to indirectly access a password so that
the password itself does not appear in the configuration file. </p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ghgrf">To Create a Password Alias</a></p></li>
<li><p><a href="#ghgsr">To List Password Aliases</a></p></li>
<li><p><a href="#ghgnv">To Delete a Password Alias</a></p></li>
<li><p><a href="#giobz">To Update a Password Alias</a></p></li></ul>


<a name="ghgrf"></a><h5>To Create a Password Alias</h5>
<a name="indexterm-474"></a><a name="indexterm-475"></a><a name="indexterm-476"></a><p>Use the <tt>create-password-alias</tt> subcommand in remote mode to create an alias for a
password in the domain's keystore. The password corresponding to the alias name is
stored in an encrypted form in the domain configuration file. The <tt>create-password-alias</tt> subcommand takes
both a secure interactive form, in which users are prompted for all information,
and a more script-friendly form, in which the password is propagated on the
command line.<a name="indexterm-477"></a><a name="indexterm-478"></a></p><p>You can also use the <a href="http://docs.sun.com/doc/820-7701/set-1?a=view"><tt>set</tt>(1)</a> subcommand to remove and replace the password
in the configuration file. For example:</p><pre>asadmin set --user admin server.jms-service.jms-host.default_JMS_host.
admin-password='${ALIAS=jms-password}'</pre><ol>
<li><b>Ensure that the server is running.</b><p>Remote subcommands require a running server.</p></li>
<li><b>Go to the directory where the configuration file resides.</b><p>By default, the configuration file is located in <i>domain-dir</i><tt>/config</tt>.</p></li>
<li><b>Create the password alias by using the <a href="http://docs.sun.com/doc/820-7701/create-password-alias-1?a=view"><tt>create-password-alias</tt>(1)</a> subcommand.</b></li>
<li><b>Type the password for the alias when prompted.</b></li>
<li><b>Add the alias to a password file.</b><p>In the password file, for example, <tt>passwords.txt</tt>, add the following line: <tt>AS_ADMIN_PASSWORD=${ALIAS=<i>admin-password-alias</i>}</tt>, where <i>admin-password-alias</i>
is the new password alias.</p></li>
<li><b>Stop the Enterprise Server domain.</b><p>See <a href="p7.html#ggoch">To Stop a Domain</a>.</p></li>
<li><b>Start the domain specifying the file that contains the alias. </b><p>For example:</p><pre>asadmin start-domain --user admin --passwordfile /<i>path-to</i>/passwords.txt domain1</pre></li></ol><a name="ginvi"></a><h6>Example&#160;11-3 Creating a Password Alias</h6><p>This example creates the new <tt>jms-password</tt> alias for the <tt>admin</tt> user:</p><pre>asadmin> <tt><b>create-password-alias --user admin jms-password</b></tt></pre><p>You are prompted to type the password for the alias:</p><pre>Please enter the alias password><tt><b>secret-password</b></tt>
Please enter the alias password again><tt><b>secret-password</b></tt>
Command create-password-alias executed successfully.</pre><h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help create-password-alias</tt> at the command line.</p>

<a name="ghgsr"></a><h5>To List Password Aliases</h5>
<a name="indexterm-479"></a><a name="indexterm-480"></a><a name="indexterm-481"></a><p>Use the <tt>list-password-aliases</tt> subcommand in remote mode to list existing the password aliases.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote subcommands require a running server.</p></li>
<li><b>List password aliases by using the <a href="http://docs.sun.com/doc/820-7701/list-password-aliases-1?a=view"><tt>list-password-aliases</tt>(1)</a> subcommand.</b></li></ol><a name="ginsk"></a><h6>Example&#160;11-4 Listing Password Aliases</h6><p>This example lists the existing password aliases:</p><pre>asadmin> <tt><b>list-password aliases</b></tt>
jmspassword-alias
Command list-password-aliases executed successfully</pre><h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help list-password-aliases</tt> at the command line.</p>

<a name="ghgnv"></a><h5>To Delete a Password Alias</h5>
<a name="indexterm-482"></a><a name="indexterm-483"></a><a name="indexterm-484"></a><p>Use the <tt>delete-password-alias</tt> subcommand in remote mode to delete an existing password alias.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote subcommands require a running server.</p></li>
<li><b>List all aliases by using the <a href="http://docs.sun.com/doc/820-7701/list-password-aliases-1?a=view"><tt>list-password-aliases</tt>(1)</a> subcommand.</b></li>
<li><b>Delete a password alias by using the <a href="http://docs.sun.com/doc/820-7701/list-password-aliases-1?a=view"><tt>list-password-aliases</tt>(1)</a> subcommand.</b></li></ol><a name="ginul"></a><h6>Example&#160;11-5 Deleting a Password Alias</h6><p>This example deletes the password alias <tt>jmspassword-alias</tt>:</p><pre>asadmin> <tt><b>delete-password-alias jmspassword-alias</b></tt>
Command list-password-aliases executed successfully</pre><h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help delete-password-alias</tt> at the command line.</p>

<a name="giobz"></a><h5>To Update a Password Alias</h5>
<a name="indexterm-485"></a><a name="indexterm-486"></a><p>Use the <tt>update-password-alias</tt> subcommand in remote mode to change the password for an
existing password alias. The <tt>update-password-alias</tt> subcommand takes both a secure interactive form,
in which the user is prompted for all information, and a more script-friendly
form, in which the password is propagated on the command line.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote subcommands require a running server.</p></li>
<li><b>Update an alias by using the <a href="http://docs.sun.com/doc/820-7701/update-password-alias-1?a=view"><tt>update-password-alias</tt>(1)</a> subcommand.</b></li>
<li><b>Type the password when prompted.</b></li></ol><a name="giodl"></a><h6>Example&#160;11-6 Updating a Password Alias</h6><p>This example updates the password for the <tt>jmspassword-alias</tt> alias:</p><pre>asadmin> <tt><b>update-password-allias /home/password.txt jsmpassword-alias</b></tt></pre><p>You are prompted to type the new password for the alias:</p><pre>Please enter the alias password><tt><b>new-secret-password</b></tt>
Please enter the alias password again><tt><b>new-secret-password</b></tt>
Command update-password-alias executed successfully</pre><h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help update-password-alias</tt> at the command line.</p>

<a name="ghgol"></a><h3>Administering Audit Modules</h3>
<p>The following topics are addressed here:</p>
<ul><li><p><a href="#ghgra">To Create an Audit Module</a></p></li>
<li><p><a href="#ghgsm">To List Audit Modules</a></p></li>
<li><p><a href="#ghgpo">To Delete an Audit Module</a></p></li></ul>


<a name="ghgra"></a><h4>To Create an Audit Module</h4><a name="indexterm-487"></a><a name="indexterm-488"></a><a name="indexterm-489"></a><p>Use the <tt>create-audit-module</tt> subcommand in remote mode to create an audit module for
the add-on component that implements the audit capabilities. </p><ol>
<li><b>Ensure that the server is running.</b><p>Remote subcommands require a running server.</p></li>
<li><b>Create an audit module by using the <a href="http://docs.sun.com/doc/820-7701/create-audit-module-1?a=view"><tt>create-audit-module</tt>(1)</a> subcommand.</b><p>Information about properties for this subcommand is included in this help page.</p></li></ol><a name="ghjlw"></a><h6>Example&#160;11-7 Creating an Audit Module</h6><p>This example creates an audit module named <tt>sampleAuditModule</tt>:</p><pre>asadmin> <tt><b>create-audit-module --classname com.sun.appserv.auditmodule --property defaultuser= admin:Password=admin sampleAuditModule</b></tt>
Command create-audit-module executed successfully.</pre><h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help create-audit-module</tt> at the command line.</p>

<a name="ghgsm"></a><h4>To List Audit Modules</h4><a name="indexterm-490"></a><a name="indexterm-491"></a><a name="indexterm-492"></a><a name="indexterm-493"></a><p>Use the <tt>list-audit-modules</tt> subcommand in remote mode to list the audit modules on
one of the following targets:</p>
<ul><li><p>Server instance, <tt>server</tt> (the default)</p></li>
<li><p>Specified server instance</p></li>
<li><p>Specified configuration</p></li></ul>
<ol>
<li><b>Ensure that the server is running.</b><p>Remote subcommands require a running server.</p></li>
<li><b>List the audit modules by using the <a href="http://docs.sun.com/doc/820-7701/list-audit-modules-1?a=view"><tt>list-audit-modules</tt>(1)</a> subcommand.</b></li></ol><a name="ghjmy"></a><h6>Example&#160;11-8 Listing Audit Modules</h6><p>This example lists the audit modules on <tt>localhost</tt>:</p><pre>asadmin> <tt><b>list-audit-modules</b></tt>
audit-module : default
audit-module : sampleAuditModule
Command list-audit-modules executed successfully.</pre><h6>See Also</h6><p>You can also view the full syntax and options of the subcommand
by typing <tt>asadmin help list-audit-modules</tt> at the command line.</p>

<a name="ghgpo"></a><h4>To Delete an Audit Module</h4><a name="indexterm-494"></a><a name="indexterm-495"></a><a name="indexterm-496"></a><p>Use the <tt>delete-audit-module</tt> subcommand in remote mode to delete an existing audit module.</p><ol>
<li><b>Ensure that the server is running.</b><p>Remote subcommands require a running server.</p></li>
<li><b>List the audit modules by using the <a href="http://docs.sun.com/doc/820-7701/list-audit-modules-1?a=view"><tt>list-audit-modules</tt>(1)</a> subcommand.</b></li>
<li><b>Delete an audit module by using the <a href="http://docs.sun.com/doc/820-7701/delete-audit-module-1?a=view"><tt>delete-audit-module</tt>(1)</a> subcommand.</b></li></ol><a name="ghjhm"></a><h6>Example&#160;11-9 Deleting an Audit Module</h6><p>This example deletes <tt>sampleAuditModule</tt>:</p><pre>asadmin> <tt><b>delete-audit-module sampleAuditModule</b></tt>
Command delete-audit-module executed successfully.</pre>

<a name="ablqz"></a><h3>Administering JSSE Certificates </h3>
<a name="indexterm-497"></a><a name="indexterm-498"></a><a name="indexterm-499"></a><p> In the developer profile, the Enterprise Server v3 uses the JSSE format
on the server side to manage certificates and key stores. In all
profiles, the client side (appclient or stand-alone) uses the JSSE format. </p><p>The J2SE SDK ships with the <tt>keytool</tt> utility, which enables you to set
up and work with Java Secure Socket Extension (JSSE) digital certificates. You can
administer public/private key pairs and associated certificates, and cache the public keys (in
the form of certificates) of their communicating peers.</p><p>The following topics are addressed here:</p>
<ul><li><p><a href="#ghlgv">To Generate a Certificate by Using <tt>keytool</tt></a></p></li>
<li><p><a href="#ghlgj">To Sign a Certificate by Using <tt>keytool</tt></a></p></li>
<li><p><a href="#ghleq">To Delete a Certificate by Using <tt>keytool</tt></a></p></li></ul>


<a name="ghlgv"></a><h4>To Generate a Certificate by Using <tt>keytool</tt></h4><a name="indexterm-500"></a><a name="indexterm-501"></a><a name="indexterm-502"></a><a name="indexterm-503"></a><p>By default, the <tt>keytool</tt> utility creates a keystore file in the directory where
the utility is run.</p><h6>Before You Begin</h6><p>To run the <tt>keytool</tt> utility, your shell environment must be configured so that
the J2SE <tt>/bin</tt> directory is in the path, otherwise the full path to
the utility must be present on the command line. </p><ol>
<li><b>Change to the directory that contains the keystore and truststore files.</b><p>Always generate the certificate in the directory containing the keystore and truststore files.
The default is <i>domain-dir</i><tt>/config</tt>. </p></li>
<li><b>Generate the certificate in the keystore file, <tt>keystore.jks</tt>, using the following command format:</b><pre>keytool -genkey -alias <i>keyAlias</i>-keyalg RSA
 -keypass changeit
 -storepass changeit
keystore keystore.jks</pre><p>Use any unique name as your <i>keyAlias</i>. If you have changed the keystore
or private key password from the default (<tt>changeit</tt>), substitute the new password
for <tt>changeit</tt>. The default key password alias is <tt>s1as</tt>.</p><p>A prompt appears that asks for your name, organization, and other information.</p></li>
<li><b>Export the generated certificate to the <tt>server.cer</tt> file (or <tt>client.cer</tt> if you prefer),
using the following command format:</b><pre>keytool -export -alias <i>keyAlias</i>-storepass changeit
 -file server.cer
 -keystore keystore.jks</pre></li>
<li><b>If a certificate signed by a certificate authority is required, see <a href="#ghlgj">To Sign a Certificate by Using <tt>keytool</tt></a>.</b></li>
<li><b>Create the <tt>cacerts.jks</tt> truststore file and add the certificate to the truststore, using
the following command format:</b><pre>keytool -import -v -trustcacerts
-alias <i>keyAlias</i>
 -file server.cer
-keystore cacerts.jks
 -keypass changeit</pre><p>If you have changed the keystore or private key password from the
default (<tt>changeit</tt>), substitute the new password.</p><p>Information about the certificate is displayed and a prompt appears asking if you
want to trust the certificate.</p></li>
<li><b>Type <tt>yes</tt>, then press Enter.</b><p>Information similar to the following is displayed:</p><pre>Certificate was added to keystore
[Saving cacerts.jks]</pre></li>
<li><b>To apply your changes, restart Enterprise Server. See <a href="p7.html#ginqj">To Restart a Domain</a>.</b></li></ol><a name="ghlii"></a><h6>Example&#160;11-10 Creating a Self-Signed Certificate in a JKS Keystore by Using an RSA Key Algorithm</h6><p>RSA is public-key encryption technology developed by RSA Data Security, Inc.</p><pre><tt><b>keytool -genkey -noprompt -trustcacerts -keyalg RSA -alias ${cert.alias} -dname ${dn.name} -keypass ${key.pass} -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><a name="ghlew"></a><h6>Example&#160;11-11 Creating a Self-Signed Certificate in a JKS Keystore by Using a Default Key Algorithm</h6><pre><tt><b>keytool -genkey -noprompt -trustcacerts -alias ${cert.alias} -dname ${dn.name} -keypass ${key.pass} -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><a name="ghldw"></a><h6>Example&#160;11-12 Displaying Available Certificates From a JKS Keystore</h6><pre><tt><b>keytool -list -v -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><a name="ghlfd"></a><h6>Example&#160;11-13 Displaying Certificate information From a JKS Keystore</h6><pre><tt><b>keytool -list -v -alias ${cert.alias} -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><h6>See Also</h6><p>For more information about <tt>keytool</tt>, see the <tt>keytool</tt> documentation at <a href="http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html">http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html</a>.</p>

<a name="ghlgj"></a><h4>To Sign a Certificate by Using <tt>keytool</tt></h4><a name="indexterm-504"></a><a name="indexterm-505"></a><a name="indexterm-506"></a><p>After creating a certificate, the owner must sign the certificate to prevent forgery.
E-commerce sites, or those for which authentication of identity is important, can purchase
a certificate from a well-known Certificate Authority (CA). </p>
<hr><p><b>Note - </b>If authentication is not a concern, for example if private secure communications are
all that is required, you can save the time and expense involved in
obtaining a CA certificate by using a self-signed certificate.</p>
<hr>
<ol>
<li><b>Follow the instructions on the CA's web site for generating certificate key pairs.</b></li>
<li><b>Download the generated certificate key pair.</b><p>Save the certificate in the directory containing the keystore and truststore files. The default
is <i>domain-dir</i><tt>/config</tt>.</p></li>
<li><b>In your shell, change to the directory containing the certificate.</b></li>
<li><b>Import the certificate into the local keystore and, if necessary, the local truststore
using the following command format:</b><pre>keytool -import -v -trustcacerts
-alias <i>keyAlias</i>
 -file server.cer
-keystore cacerts.jks
 -keypass changeit
-storepass changeit</pre><p>If the keystore or private key password is not the default password, then
substitute the new password for the default (<tt>changeit</tt>).</p></li>
<li><b>To apply your changes, restart Enterprise Server. See <a href="p7.html#ginqj">To Restart a Domain</a>.</b></li></ol><a name="ghlhu"></a><h6>Example&#160;11-14 Importing an RFC/Text-Formatted Certificate Into a JKS Keystore</h6><p>Certificates are often stored using the printable encoding format defined by the Internet
Request for Comments (RFC) 1421 standard instead of their binary encoding. This certificate
format, also known as Base 64 encoding, facilitates exporting certificates to other applications
by email or through some other mechanism.</p><pre><tt><b>keytool -import -noprompt -trustcacerts -alias ${cert.alias} -file ${cert.file} -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><a name="ghlim"></a><h6>Example&#160;11-15 Exporting a Certificate From a JKS Keystore in PKCS7 Format</h6><p>The reply format defined by the Public Key Cryptography Standards #7, Cryptographic Message
Syntax Standard, includes the supporting certificate chain in addition to the issued certificate.</p><pre><tt><b>keytool -export -noprompt -alias ${cert.alias} -file ${cert.file} -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><a name="ghleb"></a><h6>Example&#160;11-16 Exporting a Certificate From a JKS Keystore in RFC/Text Format</h6><pre><tt><b>keytool -export -noprompt -rfc -alias ${cert.alias} -file ${cert.file} -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><h6>See Also</h6><p>For more information about <tt>keytool</tt>, see the <tt>keytool</tt> documentation at <a href="http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html">http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html</a></p>

<a name="ghleq"></a><h4>To Delete a Certificate by Using <tt>keytool</tt></h4><a name="indexterm-507"></a><a name="indexterm-508"></a><a name="indexterm-509"></a><p>Use the <tt>keytool <tt>-delete</tt></tt> command to delete an existing certificate.</p><ul>
<li><b>Delete a certificate using the following command format:</b><pre>keytool -delete
 -alias <i>keyAlias</i>
 -keystore <i>keystore-name</i>
 -storepass <i>password</i></pre></li></ul><a name="ghlgy"></a><h6>Example&#160;11-17 Deleting a Certificate From a JKS Keystore</h6><pre><tt><b>keytool -delete -noprompt -alias ${cert.alias} -keystore ${keystore.file} -storepass ${keystore.pass}</b></tt></pre><h6>See Also</h6><p>For more information about <tt>keytool</tt>, see the <tt>keytool</tt> documentation at <a href="http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html">http://java.sun.com/j2se/1.5.0/docs/tooldocs/solaris/keytool.html</a>.</p>


<table border="0" cellpadding="5" cellspacing="0" width="100%">
<tr valign="bottom">
<td></td>
<td style="width: 60%"></td>
<td><a href="p15.html">Previous</a></td>
<td></td>
<td><a href="idx-1.html">Index</a></td>
<td><a href="p17.html">Next</a></td>
</tr>
</table>



</body>
</html>

